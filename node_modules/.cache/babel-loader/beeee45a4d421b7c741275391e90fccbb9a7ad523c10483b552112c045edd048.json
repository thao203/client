{"ast":null,"code":"import classNames from'classnames/bind';import styles from'./Login.module.scss';import request from'../../config/Connect';import Button from'@mui/material/Button';import TextField from'@mui/material/TextField';import Checkbox from'@mui/material/Checkbox';import FormControlLabel from'@mui/material/FormControlLabel';import{Link,useNavigate}from'react-router-dom';import{useEffect,useState}from'react';import{ToastContainer,toast}from'react-toastify';import'react-toastify/dist/ReactToastify.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const cx=classNames.bind(styles);function Login(){const navigate=useNavigate();const[masinhvien,setmasinhvien]=useState('');const[password,setPassword]=useState('');const[checkSaveLogin,setCheckSaveLogin]=useState(true);useEffect(()=>{document.title=\"Đăng nhập\";const savedMaSinhVien=localStorage.getItem('masinhvien');const savedPassword=localStorage.getItem('password');if(savedMaSinhVien)setmasinhvien(savedMaSinhVien);if(savedPassword)setPassword(savedPassword);},[]);const handleLogin=async()=>{try{const data={masinhvien,password};const res=await request.post('api/login',data);if(res.data.token){const hostname=window.location.hostname;const cookieOptions={path:'/',domain:hostname==='localhost'?undefined:hostname,expires:new Date(Date.now()+7*24*60*60*1000)};const cookieString=Object.entries(cookieOptions).filter(_ref=>{let[key,value]=_ref;return value!==undefined;}).map(_ref2=>{let[key,value]=_ref2;return`${key}=${value}`;}).join('; ');document.cookie=`token=${res.data.token}; ${cookieString}`;window.location.href='/homepage';}if(checkSaveLogin){localStorage.setItem('masinhvien',masinhvien);localStorage.setItem('password',password);}else{localStorage.removeItem('masinhvien');localStorage.removeItem('password');}}catch(error){toast.error(error.response.data.message);}};return/*#__PURE__*/_jsxs(\"div\",{className:cx('wrapper'),children:[/*#__PURE__*/_jsx(ToastContainer,{}),/*#__PURE__*/_jsxs(\"div\",{className:cx('inner'),children:[/*#__PURE__*/_jsxs(\"div\",{className:cx('column-left'),children:[/*#__PURE__*/_jsxs(\"div\",{className:cx('text-container'),children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Th\\u01B0 vi\\u1EC7n tr\\u1EF1c tuy\\u1EBFn\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0110\\u1EA1i H\\u1ECDc Kinh T\\u1EBF - K\\u0129 Thu\\u1EADt C\\xF4ng Nghi\\u1EC7p\"})]}),/*#__PURE__*/_jsx(\"div\",{className:cx('image-container'),children:/*#__PURE__*/_jsx(\"img\",{src:\"/Books_preview.png\",alt:\"H\\xECnh \\u1EA3nh th\\u01B0 vi\\u1EC7n\",className:cx('animated-image')})})]}),/*#__PURE__*/_jsxs(\"div\",{className:cx('column-right'),children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u0110\\u0103ng Nh\\u1EADp\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Ch\\xE0o m\\u1EEBng \\u0111\\u1EBFn v\\u1EDBi c\\u01A1 s\\u1EDF d\\u1EEF li\\u1EC7u tr\\u1EF1c tuy\\u1EBFn\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:e=>{e.preventDefault();handleLogin();},children:[/*#__PURE__*/_jsx(TextField,{id:\"username-field\",label:\"M\\xE3 sinh vi\\xEAn c\\u1EE7a b\\u1EA1n\",variant:\"outlined\",size:\"medium\",fullWidth:true,autoComplete:\"username\",value:masinhvien,onChange:e=>setmasinhvien(e.target.value),margin:\"normal\"}),/*#__PURE__*/_jsx(TextField,{id:\"password-field\",label:\"M\\u1EADt Kh\\u1EA9u\",variant:\"outlined\",type:\"password\",size:\"medium\",fullWidth:true,autoComplete:\"current-password\",value:password,onChange:e=>setPassword(e.target.value),margin:\"normal\"}),/*#__PURE__*/_jsxs(\"div\",{className:cx('remember-me'),children:[/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Checkbox,{checked:checkSaveLogin,onChange:e=>setCheckSaveLogin(e.target.checked)}),label:\"Nh\\u1EDB t\\xE0i kho\\u1EA3n c\\u1EE7a t\\xF4i\"}),/*#__PURE__*/_jsx(Link,{to:\"/forgot\",className:cx('forgot-password'),children:\"Qu\\xEAn M\\u1EADt Kh\\u1EA9u ?\"})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",fullWidth:true,size:\"large\",className:cx('login-button'),children:\"\\u0110\\u0103ng Nh\\u1EADp\"})]}),/*#__PURE__*/_jsx(\"div\",{className:cx('register-link'),children:/*#__PURE__*/_jsx(Link,{to:\"/reg\",children:\"B\\u1EA1n Ch\\u01B0a C\\xF3 T\\xE0i Kho\\u1EA3n ?\"})})]})]})]});}export default Login;","map":{"version":3,"names":["classNames","styles","request","Button","TextField","Checkbox","FormControlLabel","Link","useNavigate","useEffect","useState","ToastContainer","toast","jsx","_jsx","jsxs","_jsxs","cx","bind","Login","navigate","masinhvien","setmasinhvien","password","setPassword","checkSaveLogin","setCheckSaveLogin","document","title","savedMaSinhVien","localStorage","getItem","savedPassword","handleLogin","data","res","post","token","hostname","window","location","cookieOptions","path","domain","undefined","expires","Date","now","cookieString","Object","entries","filter","_ref","key","value","map","_ref2","join","cookie","href","setItem","removeItem","error","response","message","className","children","src","alt","onSubmit","e","preventDefault","id","label","variant","size","fullWidth","autoComplete","onChange","target","margin","type","control","checked","to"],"sources":["E:/Documents/Hoc_Tap/LATN/client/src/Page/Login/Login.js"],"sourcesContent":["import classNames from 'classnames/bind';\r\nimport styles from './Login.module.scss';\r\nimport request from '../../config/Connect';\r\nimport Button from '@mui/material/Button';\r\nimport TextField from '@mui/material/TextField';\r\nimport Checkbox from '@mui/material/Checkbox';\r\nimport FormControlLabel from '@mui/material/FormControlLabel';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { useEffect, useState } from 'react';\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\n\r\nconst cx = classNames.bind(styles);\r\n\r\nfunction Login() {\r\n    const navigate = useNavigate();\r\n    const [masinhvien, setmasinhvien] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [checkSaveLogin, setCheckSaveLogin] = useState(true);\r\n\r\n    useEffect(() => {\r\n        document.title = \"Đăng nhập\";\r\n        const savedMaSinhVien = localStorage.getItem('masinhvien');\r\n        const savedPassword = localStorage.getItem('password');\r\n        if (savedMaSinhVien) setmasinhvien(savedMaSinhVien);\r\n        if (savedPassword) setPassword(savedPassword);\r\n    }, []);\r\n\r\n    const handleLogin = async () => {\r\n        try {\r\n            const data = { masinhvien, password };\r\n            const res = await request.post('api/login', data);\r\n            if (res.data.token) {\r\n                const hostname = window.location.hostname;\r\n                const cookieOptions = {\r\n                    path: '/',\r\n                    domain: hostname === 'localhost' ? undefined : hostname,\r\n                    expires: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\r\n                };\r\n\r\n                const cookieString = Object.entries(cookieOptions)\r\n                    .filter(([key, value]) => value !== undefined)\r\n                    .map(([key, value]) => `${key}=${value}`)\r\n                    .join('; ');\r\n\r\n                document.cookie =  `token=${res.data.token}; ${cookieString}`;\r\n                window.location.href = '/homepage';\r\n            }\r\n\r\n            if (checkSaveLogin) {\r\n                localStorage.setItem('masinhvien', masinhvien);\r\n                localStorage.setItem('password', password);\r\n            } else {\r\n                localStorage.removeItem('masinhvien');\r\n                localStorage.removeItem('password');\r\n            }\r\n        } catch (error) {\r\n            toast.error(error.response.data.message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className={cx('wrapper')}>\r\n            <ToastContainer />\r\n            <div className={cx('inner')}>\r\n                <div className={cx('column-left')}>\r\n                    <div className={cx('text-container')}>\r\n                        <h1>Thư viện trực tuyến</h1>\r\n                        <h2>Đại Học Kinh Tế - Kĩ Thuật Công Nghiệp</h2>\r\n                    </div>\r\n                    <div className={cx('image-container')}>\r\n                        <img src=\"/Books_preview.png\" alt=\"Hình ảnh thư viện\" className={cx('animated-image')} />\r\n                    </div>\r\n                </div>\r\n                <div className={cx('column-right')}>\r\n                    <h1>Đăng Nhập</h1>\r\n                    <span>Chào mừng đến với cơ sở dữ liệu trực tuyến</span>\r\n                    <form onSubmit={(e) => { e.preventDefault(); handleLogin(); }}>\r\n                        <TextField\r\n                            id=\"username-field\"\r\n                            label=\"Mã sinh viên của bạn\"\r\n                            variant=\"outlined\"\r\n                            size=\"medium\"\r\n                            fullWidth\r\n                            autoComplete=\"username\"\r\n                            value={masinhvien}\r\n                            onChange={(e) => setmasinhvien(e.target.value)}\r\n                            margin=\"normal\"\r\n                        />\r\n                        <TextField\r\n                            id=\"password-field\"\r\n                            label=\"Mật Khẩu\"\r\n                            variant=\"outlined\"\r\n                            type=\"password\"\r\n                            size=\"medium\"\r\n                            fullWidth\r\n                            autoComplete=\"current-password\"\r\n                            value={password}\r\n                            onChange={(e) => setPassword(e.target.value)}\r\n                            margin=\"normal\"\r\n                        />\r\n                        <div className={cx('remember-me')}>\r\n                            <FormControlLabel\r\n                                control={<Checkbox checked={checkSaveLogin} onChange={(e) => setCheckSaveLogin(e.target.checked)} />}\r\n                                label=\"Nhớ tài khoản của tôi\"\r\n                            />\r\n                            <Link to=\"/forgot\" className={cx('forgot-password')}>\r\n                                Quên Mật Khẩu ?\r\n                            </Link>\r\n                        </div>\r\n                        <Button type=\"submit\" variant=\"contained\" fullWidth size=\"large\" className={cx('login-button')}>\r\n                            Đăng Nhập\r\n                        </Button>\r\n                    </form>\r\n                    <div className={cx('register-link')}>\r\n                        <Link to=\"/reg\">Bạn Chưa Có Tài Khoản ?</Link>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Login;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}