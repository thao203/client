{"ast":null,"code":"// <DOCUMENT filename=\"ModalCart.js\">\nimport{useState,useEffect}from'react';import Button from'react-bootstrap/Button';import Modal from'react-bootstrap/Modal';import{ToastContainer,toast}from'react-toastify';import'react-toastify/dist/ReactToastify.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function ModalCart(_ref){let{show,setShow,masach,tensach,vitri,img,onAddToCart}=_ref;const handleClose=()=>setShow(false);const[quantity,setQuantity]=useState(1);// Đặt ngày mượn mặc định là hôm nay\nuseEffect(()=>{const today=new Date().toISOString().split('T')[0];setNgaymuon(today);},[]);const[ngaymuon,setNgaymuon]=useState('');const[mavitri,setMavitri]=useState('');const[locations,setLocations]=useState([]);useEffect(()=>{if(show&&vitri&&Array.isArray(vitri)){var _vitri$;setLocations(vitri);setMavitri(((_vitri$=vitri[0])===null||_vitri$===void 0?void 0:_vitri$.mavitri)||'');// Chọn vị trí đầu tiên mặc định\n}else if(show){toast.error('Không có thông tin vị trí sách!');setLocations([]);setMavitri('');}},[show,vitri]);const toastOptions={position:'top-right',autoClose:1000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined,onClose:handleClose};const handleAddToCart=()=>{const selectedLocation=locations.find(loc=>loc.mavitri===mavitri);const availableQuantity=selectedLocation?selectedLocation.soluong-selectedLocation.soluongmuon:0;if(quantity<=0||quantity>availableQuantity){toast.error(`Số lượng không hợp lệ! Chỉ còn ${availableQuantity} sách có thể mượn.`,toastOptions);return;}const cartItem={masach,tensach,quantity:parseInt(quantity),mavitri,ngaymuon,img};if(onAddToCart){onAddToCart(cartItem);toast.success('Thêm sách vào giỏ hàng thành công!',toastOptions);}else{toast.error('Lỗi: Không thể thêm vào giỏ hàng!',toastOptions);}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ToastContainer,{}),/*#__PURE__*/_jsxs(Modal,{show:show,onHide:handleClose,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Th\\xEAm S\\xE1ch V\\xE0o Gi\\u1ECF H\\xE0ng\"})}),/*#__PURE__*/_jsxs(Modal.Body,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-floating mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{value:masach||'',className:\"form-control\",disabled:true}),/*#__PURE__*/_jsx(\"label\",{children:\"M\\xE3 S\\xE1ch\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-floating mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{value:tensach||'',className:\"form-control\",disabled:true}),/*#__PURE__*/_jsx(\"label\",{children:\"T\\xEAn S\\xE1ch\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-floating mb-3\",children:[/*#__PURE__*/_jsx(\"select\",{className:\"form-control\",value:mavitri,onChange:e=>setMavitri(e.target.value),children:locations.length>0?locations.map(loc=>/*#__PURE__*/_jsxs(\"option\",{value:loc.mavitri,children:[loc.mavitri,\" (S\\u1ED1 l\\u01B0\\u1EE3ng c\\xF3 th\\u1EC3 m\\u01B0\\u1EE3n: \",loc.soluong-loc.soluongmuon,\")\"]},loc.mavitri)):/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Kh\\xF4ng c\\xF3 v\\u1ECB tr\\xED n\\xE0o\"})}),/*#__PURE__*/_jsx(\"label\",{children:\"M\\xE3 V\\u1ECB Tr\\xED\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-floating mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\",className:\"form-control\",value:ngaymuon,min:new Date().toISOString().split('T')[0],onChange:e=>setNgaymuon(e.target.value)}),/*#__PURE__*/_jsx(\"label\",{children:\"Ng\\xE0y M\\u01B0\\u1EE3n\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-floating mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"form-control\",min:\"1\",value:quantity,onChange:e=>setQuantity(e.target.value)}),/*#__PURE__*/_jsx(\"label\",{children:\"S\\u1ED1 L\\u01B0\\u1EE3ng\"})]})]}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:handleClose,children:\"\\u0110\\xF3ng\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:handleAddToCart,disabled:!mavitri,children:\"Th\\xEAm V\\xE0o Gi\\u1ECF H\\xE0ng\"})]})]})]});}export default ModalCart;// </DOCUMENT>","map":{"version":3,"names":["useState","useEffect","Button","Modal","ToastContainer","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ModalCart","_ref","show","setShow","masach","tensach","vitri","img","onAddToCart","handleClose","quantity","setQuantity","today","Date","toISOString","split","setNgaymuon","ngaymuon","mavitri","setMavitri","locations","setLocations","Array","isArray","_vitri$","error","toastOptions","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","onClose","handleAddToCart","selectedLocation","find","loc","availableQuantity","soluong","soluongmuon","cartItem","parseInt","success","children","onHide","Header","closeButton","Title","Body","className","value","disabled","onChange","e","target","length","map","type","min","Footer","variant","onClick"],"sources":["E:/Documents/Hoc_Tap/LATN/client/src/Page/HomePage/Layouts/Main/Modal/ModalCart.js"],"sourcesContent":["// <DOCUMENT filename=\"ModalCart.js\">\r\nimport { useState, useEffect } from 'react';\r\nimport Button from 'react-bootstrap/Button';\r\nimport Modal from 'react-bootstrap/Modal';\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\n\r\nfunction ModalCart({ show, setShow, masach, tensach, vitri, img, onAddToCart }) {\r\n    const handleClose = () => setShow(false);\r\n    const [quantity, setQuantity] = useState(1);\r\n\r\n    // Đặt ngày mượn mặc định là hôm nay\r\n    useEffect(() => {\r\n        const today = new Date().toISOString().split('T')[0];\r\n        setNgaymuon(today);\r\n    }, []);\r\n\r\n\r\n    const [ngaymuon, setNgaymuon] = useState('');\r\n    const [mavitri, setMavitri] = useState('');\r\n    const [locations, setLocations] = useState([]);\r\n\r\n    useEffect(() => {\r\n        if (show && vitri && Array.isArray(vitri)) {\r\n            setLocations(vitri);\r\n            setMavitri(vitri[0]?.mavitri || ''); // Chọn vị trí đầu tiên mặc định\r\n        } else if (show) {\r\n            toast.error('Không có thông tin vị trí sách!');\r\n            setLocations([]);\r\n            setMavitri('');\r\n        }\r\n    }, [show, vitri]);\r\n\r\n    const toastOptions = {\r\n        position: 'top-right',\r\n        autoClose: 1000,\r\n        hideProgressBar: false,\r\n        closeOnClick: true,\r\n        pauseOnHover: true,\r\n        draggable: true,\r\n        progress: undefined,\r\n        onClose: handleClose,\r\n    };\r\n\r\n    const handleAddToCart = () => {\r\n        const selectedLocation = locations.find((loc) => loc.mavitri === mavitri);\r\n        const availableQuantity = selectedLocation ? selectedLocation.soluong - selectedLocation.soluongmuon : 0;\r\n\r\n        if (quantity <= 0 || quantity > availableQuantity) {\r\n            toast.error(`Số lượng không hợp lệ! Chỉ còn ${availableQuantity} sách có thể mượn.`, toastOptions);\r\n            return;\r\n        }\r\n\r\n        const cartItem = {\r\n            masach,\r\n            tensach,\r\n            quantity: parseInt(quantity),\r\n            mavitri,\r\n            ngaymuon,\r\n            img,\r\n        };\r\n\r\n        if (onAddToCart) {\r\n            onAddToCart(cartItem);\r\n            toast.success('Thêm sách vào giỏ hàng thành công!', toastOptions);\r\n        } else {\r\n            toast.error('Lỗi: Không thể thêm vào giỏ hàng!', toastOptions);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <ToastContainer />\r\n            <Modal show={show} onHide={handleClose}>\r\n                <Modal.Header closeButton>\r\n                    <Modal.Title>Thêm Sách Vào Giỏ Hàng</Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    <div className=\"form-floating mb-3\">\r\n                        <input value={masach || ''} className=\"form-control\" disabled />\r\n                        <label>Mã Sách</label>\r\n                    </div>\r\n                    <div className=\"form-floating mb-3\">\r\n                        <input value={tensach || ''} className=\"form-control\" disabled />\r\n                        <label>Tên Sách</label>\r\n                    </div>\r\n                    <div className=\"form-floating mb-3\">\r\n                        <select\r\n                            className=\"form-control\"\r\n                            value={mavitri}\r\n                            onChange={(e) => setMavitri(e.target.value)}\r\n                        >\r\n                            {locations.length > 0 ? (\r\n                                locations.map((loc) => (\r\n                                    <option key={loc.mavitri} value={loc.mavitri}>\r\n                                        {loc.mavitri} (Số lượng có thể mượn: {loc.soluong - loc.soluongmuon})\r\n                                    </option>\r\n                                ))\r\n                            ) : (\r\n                                <option value=\"\">Không có vị trí nào</option>\r\n                            )}\r\n                        </select>\r\n                        <label>Mã Vị Trí</label>\r\n                    </div>\r\n                    <div className=\"form-floating mb-3\">\r\n                        <input\r\n                            type=\"date\"\r\n                            className=\"form-control\"\r\n                            value={ngaymuon}\r\n                            min={new Date().toISOString().split('T')[0]}\r\n                            onChange={(e) => setNgaymuon(e.target.value)}\r\n                        />\r\n                        <label>Ngày Mượn</label>\r\n                    </div>\r\n                    <div className=\"form-floating mb-3\">\r\n                        <input\r\n                            type=\"number\"\r\n                            className=\"form-control\"\r\n                            min=\"1\"\r\n                            value={quantity}\r\n                            onChange={(e) => setQuantity(e.target.value)}\r\n                        />\r\n                        <label>Số Lượng</label>\r\n                    </div>\r\n                </Modal.Body>\r\n                <Modal.Footer>\r\n                    <Button variant=\"secondary\" onClick={handleClose}>\r\n                        Đóng\r\n                    </Button>\r\n                    <Button variant=\"primary\" onClick={handleAddToCart} disabled={!mavitri}>\r\n                        Thêm Vào Giỏ Hàng\r\n                    </Button>\r\n                </Modal.Footer>\r\n            </Modal>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default ModalCart;\r\n// </DOCUMENT>"],"mappings":"AAAA;AACA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,MAAO,CAAAC,MAAM,KAAM,wBAAwB,CAC3C,MAAO,CAAAC,KAAK,KAAM,uBAAuB,CACzC,OAASC,cAAc,CAAEC,KAAK,KAAQ,gBAAgB,CACtD,MAAO,uCAAuC,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAE/C,QAAS,CAAAC,SAASA,CAAAC,IAAA,CAA8D,IAA7D,CAAEC,IAAI,CAAEC,OAAO,CAAEC,MAAM,CAAEC,OAAO,CAAEC,KAAK,CAAEC,GAAG,CAAEC,WAAY,CAAC,CAAAP,IAAA,CAC1E,KAAM,CAAAQ,WAAW,CAAGA,CAAA,GAAMN,OAAO,CAAC,KAAK,CAAC,CACxC,KAAM,CAACO,QAAQ,CAAEC,WAAW,CAAC,CAAGvB,QAAQ,CAAC,CAAC,CAAC,CAE3C;AACAC,SAAS,CAAC,IAAM,CACZ,KAAM,CAAAuB,KAAK,CAAG,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CACpDC,WAAW,CAACJ,KAAK,CAAC,CACtB,CAAC,CAAE,EAAE,CAAC,CAGN,KAAM,CAACK,QAAQ,CAAED,WAAW,CAAC,CAAG5B,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAAC8B,OAAO,CAAEC,UAAU,CAAC,CAAG/B,QAAQ,CAAC,EAAE,CAAC,CAC1C,KAAM,CAACgC,SAAS,CAAEC,YAAY,CAAC,CAAGjC,QAAQ,CAAC,EAAE,CAAC,CAE9CC,SAAS,CAAC,IAAM,CACZ,GAAIa,IAAI,EAAII,KAAK,EAAIgB,KAAK,CAACC,OAAO,CAACjB,KAAK,CAAC,CAAE,KAAAkB,OAAA,CACvCH,YAAY,CAACf,KAAK,CAAC,CACnBa,UAAU,CAAC,EAAAK,OAAA,CAAAlB,KAAK,CAAC,CAAC,CAAC,UAAAkB,OAAA,iBAARA,OAAA,CAAUN,OAAO,GAAI,EAAE,CAAC,CAAE;AACzC,CAAC,IAAM,IAAIhB,IAAI,CAAE,CACbT,KAAK,CAACgC,KAAK,CAAC,iCAAiC,CAAC,CAC9CJ,YAAY,CAAC,EAAE,CAAC,CAChBF,UAAU,CAAC,EAAE,CAAC,CAClB,CACJ,CAAC,CAAE,CAACjB,IAAI,CAAEI,KAAK,CAAC,CAAC,CAEjB,KAAM,CAAAoB,YAAY,CAAG,CACjBC,QAAQ,CAAE,WAAW,CACrBC,SAAS,CAAE,IAAI,CACfC,eAAe,CAAE,KAAK,CACtBC,YAAY,CAAE,IAAI,CAClBC,YAAY,CAAE,IAAI,CAClBC,SAAS,CAAE,IAAI,CACfC,QAAQ,CAAEC,SAAS,CACnBC,OAAO,CAAE1B,WACb,CAAC,CAED,KAAM,CAAA2B,eAAe,CAAGA,CAAA,GAAM,CAC1B,KAAM,CAAAC,gBAAgB,CAAGjB,SAAS,CAACkB,IAAI,CAAEC,GAAG,EAAKA,GAAG,CAACrB,OAAO,GAAKA,OAAO,CAAC,CACzE,KAAM,CAAAsB,iBAAiB,CAAGH,gBAAgB,CAAGA,gBAAgB,CAACI,OAAO,CAAGJ,gBAAgB,CAACK,WAAW,CAAG,CAAC,CAExG,GAAIhC,QAAQ,EAAI,CAAC,EAAIA,QAAQ,CAAG8B,iBAAiB,CAAE,CAC/C/C,KAAK,CAACgC,KAAK,CAAC,kCAAkCe,iBAAiB,oBAAoB,CAAEd,YAAY,CAAC,CAClG,OACJ,CAEA,KAAM,CAAAiB,QAAQ,CAAG,CACbvC,MAAM,CACNC,OAAO,CACPK,QAAQ,CAAEkC,QAAQ,CAAClC,QAAQ,CAAC,CAC5BQ,OAAO,CACPD,QAAQ,CACRV,GACJ,CAAC,CAED,GAAIC,WAAW,CAAE,CACbA,WAAW,CAACmC,QAAQ,CAAC,CACrBlD,KAAK,CAACoD,OAAO,CAAC,oCAAoC,CAAEnB,YAAY,CAAC,CACrE,CAAC,IAAM,CACHjC,KAAK,CAACgC,KAAK,CAAC,mCAAmC,CAAEC,YAAY,CAAC,CAClE,CACJ,CAAC,CAED,mBACI7B,KAAA,CAAAE,SAAA,EAAA+C,QAAA,eACInD,IAAA,CAACH,cAAc,GAAE,CAAC,cAClBK,KAAA,CAACN,KAAK,EAACW,IAAI,CAAEA,IAAK,CAAC6C,MAAM,CAAEtC,WAAY,CAAAqC,QAAA,eACnCnD,IAAA,CAACJ,KAAK,CAACyD,MAAM,EAACC,WAAW,MAAAH,QAAA,cACrBnD,IAAA,CAACJ,KAAK,CAAC2D,KAAK,EAAAJ,QAAA,CAAC,yCAAsB,CAAa,CAAC,CACvC,CAAC,cACfjD,KAAA,CAACN,KAAK,CAAC4D,IAAI,EAAAL,QAAA,eACPjD,KAAA,QAAKuD,SAAS,CAAC,oBAAoB,CAAAN,QAAA,eAC/BnD,IAAA,UAAO0D,KAAK,CAAEjD,MAAM,EAAI,EAAG,CAACgD,SAAS,CAAC,cAAc,CAACE,QAAQ,MAAE,CAAC,cAChE3D,IAAA,UAAAmD,QAAA,CAAO,eAAO,CAAO,CAAC,EACrB,CAAC,cACNjD,KAAA,QAAKuD,SAAS,CAAC,oBAAoB,CAAAN,QAAA,eAC/BnD,IAAA,UAAO0D,KAAK,CAAEhD,OAAO,EAAI,EAAG,CAAC+C,SAAS,CAAC,cAAc,CAACE,QAAQ,MAAE,CAAC,cACjE3D,IAAA,UAAAmD,QAAA,CAAO,gBAAQ,CAAO,CAAC,EACtB,CAAC,cACNjD,KAAA,QAAKuD,SAAS,CAAC,oBAAoB,CAAAN,QAAA,eAC/BnD,IAAA,WACIyD,SAAS,CAAC,cAAc,CACxBC,KAAK,CAAEnC,OAAQ,CACfqC,QAAQ,CAAGC,CAAC,EAAKrC,UAAU,CAACqC,CAAC,CAACC,MAAM,CAACJ,KAAK,CAAE,CAAAP,QAAA,CAE3C1B,SAAS,CAACsC,MAAM,CAAG,CAAC,CACjBtC,SAAS,CAACuC,GAAG,CAAEpB,GAAG,eACd1C,KAAA,WAA0BwD,KAAK,CAAEd,GAAG,CAACrB,OAAQ,CAAA4B,QAAA,EACxCP,GAAG,CAACrB,OAAO,CAAC,2DAAwB,CAACqB,GAAG,CAACE,OAAO,CAAGF,GAAG,CAACG,WAAW,CAAC,GACxE,GAFaH,GAAG,CAACrB,OAET,CACX,CAAC,cAEFvB,IAAA,WAAQ0D,KAAK,CAAC,EAAE,CAAAP,QAAA,CAAC,sCAAmB,CAAQ,CAC/C,CACG,CAAC,cACTnD,IAAA,UAAAmD,QAAA,CAAO,sBAAS,CAAO,CAAC,EACvB,CAAC,cACNjD,KAAA,QAAKuD,SAAS,CAAC,oBAAoB,CAAAN,QAAA,eAC/BnD,IAAA,UACIiE,IAAI,CAAC,MAAM,CACXR,SAAS,CAAC,cAAc,CACxBC,KAAK,CAAEpC,QAAS,CAChB4C,GAAG,CAAE,GAAI,CAAAhD,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAE,CAC5CwC,QAAQ,CAAGC,CAAC,EAAKxC,WAAW,CAACwC,CAAC,CAACC,MAAM,CAACJ,KAAK,CAAE,CAChD,CAAC,cACF1D,IAAA,UAAAmD,QAAA,CAAO,wBAAS,CAAO,CAAC,EACvB,CAAC,cACNjD,KAAA,QAAKuD,SAAS,CAAC,oBAAoB,CAAAN,QAAA,eAC/BnD,IAAA,UACIiE,IAAI,CAAC,QAAQ,CACbR,SAAS,CAAC,cAAc,CACxBS,GAAG,CAAC,GAAG,CACPR,KAAK,CAAE3C,QAAS,CAChB6C,QAAQ,CAAGC,CAAC,EAAK7C,WAAW,CAAC6C,CAAC,CAACC,MAAM,CAACJ,KAAK,CAAE,CAChD,CAAC,cACF1D,IAAA,UAAAmD,QAAA,CAAO,yBAAQ,CAAO,CAAC,EACtB,CAAC,EACE,CAAC,cACbjD,KAAA,CAACN,KAAK,CAACuE,MAAM,EAAAhB,QAAA,eACTnD,IAAA,CAACL,MAAM,EAACyE,OAAO,CAAC,WAAW,CAACC,OAAO,CAAEvD,WAAY,CAAAqC,QAAA,CAAC,cAElD,CAAQ,CAAC,cACTnD,IAAA,CAACL,MAAM,EAACyE,OAAO,CAAC,SAAS,CAACC,OAAO,CAAE5B,eAAgB,CAACkB,QAAQ,CAAE,CAACpC,OAAQ,CAAA4B,QAAA,CAAC,iCAExE,CAAQ,CAAC,EACC,CAAC,EACZ,CAAC,EACV,CAAC,CAEX,CAEA,cAAe,CAAA9C,SAAS,CACxB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}