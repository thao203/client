{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Modal,Button,Form,DatePicker,Table,InputNumber,message,Select,Input}from'antd';import request from'../../config/Connect';import moment from'moment';import styled from'styled-components';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const{Option}=Select;// Styled Components (unchanged)\nconst StyledModal=styled(Modal)`\n    .ant-modal-content {\n        border-radius: 12px;\n        padding: 16px;\n        background: #ffffff;\n        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.1);\n    }\n    .ant-modal-header {\n        border-bottom: none;\n        padding: 16px 24px;\n    }\n    .ant-modal-title {\n        font-size: 20px;\n        font-weight: 600;\n        color: #1f2a44;\n    }\n    .ant-modal-footer {\n        border-top: none;\n        padding: 16px 24px;\n        display: flex;\n        justify-content: flex-end;\n        gap: 12px;\n    }\n`;const StyledForm=styled(Form)`\n    .ant-form-item-label > label {\n        font-weight: 500;\n        color: #344054;\n    }\n    .ant-form-item {\n        margin-bottom: 16px;\n    }\n`;const FormRow=styled.div`\n    display: flex;\n    gap: 16px;\n    .ant-form-item {\n        flex: 1;\n    }\n`;const BookSelectionSection=styled.div`\n    background: #f8fafc;\n    padding: 20px;\n    border-radius: 8px;\n    margin-bottom: 24px;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);\n`;const AddBookButton=styled(Button)`\n    background: #2563eb;\n    border: none;\n    border-radius: 6px;\n    height: 40px;\n    font-weight: 500;\n    &:hover {\n        background: #1d4ed8;\n    }\n`;const CancelButton=styled(Button)`\n    border-radius: 6px;\n    height: 40px;\n    font-weight: 500;\n    color: #344054;\n    border-color: #d1d5db;\n    &:hover {\n        border-color: #9ca3af;\n        color: #1f2a44;\n    }\n`;const SubmitButton=styled(Button)`\n    background: #16a34a;\n    border: none;\n    border-radius: 6px;\n    height: 40px;\n    font-weight: 500;\n    &:hover {\n        background: #15803d;\n    }\n`;const StyledTable=styled(Table)`\n    .ant-table {\n        border-radius: 8px;\n        overflow: hidden;\n    }\n    .ant-table-thead > tr > th {\n        background: #f1f5f9;\n        font-weight: 600;\n        color: #1f2a44;\n    }\n    .ant-table-tbody > tr:hover > td {\n        background: #f8fafc;\n    }\n`;const ModalAddHandleBook=_ref=>{let{visible,onCancel,onSuccess}=_ref;const[form]=Form.useForm();const[danhSachSach,setDanhSachSach]=useState([]);const[dangTai,setDangTai]=useState(false);const[danhSachSachApi,setDanhSachSachApi]=useState([]);const[danhSachDocGia,setDanhSachDocGia]=useState([]);const[tenSach,setTenSach]=useState('');const[danhSachViTri,setDanhSachViTri]=useState([]);// Fetch books and readers from API\nuseEffect(()=>{const fetchBooks=async()=>{try{const response=await request.get('/api/GetBooks');const data=Array.isArray(response.data)?response.data:[];setDanhSachSachApi(data);}catch(error){message.error('Không thể tải danh sách sách!',3);}};const fetchReaders=async()=>{try{const response=await request.get('/api/getAllReaders');const readers=Array.isArray(response.data.data)?response.data.data:[];console.log('Danh sách độc giả:',readers);// Debug log\nsetDanhSachDocGia(readers);}catch(error){console.error('Lỗi khi lấy danh sách độc giả:',error);message.error('Không thể tải danh sách độc giả!',3);}};fetchBooks();fetchReaders();},[]);// Handle book selection\nconst handleSelectMaSach=value=>{const sach=danhSachSachApi.find(item=>item.masach===value);if(sach){setTenSach(sach.tensach||'Không có tên sách');const viTriList=Array.isArray(sach.vitri)?sach.vitri.map(v=>v.mavitri):[];setDanhSachViTri(viTriList);form.setFieldsValue({mavitri:undefined});}else{setTenSach('');setDanhSachViTri([]);form.setFieldsValue({mavitri:undefined});}};// Table columns\nconst cot=[{title:'Mã sách',dataIndex:'masach',key:'masach'},{title:'Tên sách',dataIndex:'tensach',key:'tensach'},{title:'Mã vị trí',dataIndex:'mavitri',key:'mavitri'},{title:'Số lượng',dataIndex:'soluong',key:'soluong',render:(text,record,index)=>/*#__PURE__*/_jsx(InputNumber,{min:1,value:text,onChange:value=>xuLyThayDoiSoLuong(value,index),style:{width:'80px',borderRadius:'6px'}})},{title:'Hành động',key:'action',render:(_,__,index)=>/*#__PURE__*/_jsx(Button,{type:\"link\",danger:true,onClick:()=>xoaSach(index),style:{fontWeight:500},children:\"X\\xF3a\"})}];// Handle quantity change\nconst xuLyThayDoiSoLuong=(value,index)=>{const danhSachCapNhat=[...danhSachSach];danhSachCapNhat[index].soluong=value;setDanhSachSach(danhSachCapNhat);};// Remove book from list\nconst xoaSach=index=>{const danhSachCapNhat=danhSachSach.filter((_,i)=>i!==index);setDanhSachSach(danhSachCapNhat);};// Add book to list\nconst themSach=async()=>{try{const values=await form.validateFields(['masach','mavitri','soluong']);const sach=danhSachSachApi.find(item=>item.masach===values.masach);if(!sach){message.error('Mã sách không hợp lệ!',3);return;}if(!danhSachViTri.includes(values.mavitri)){message.error('Mã vị trí không hợp lệ cho sách này!',3);return;}const sachMoi={masach:values.masach,tensach:sach.tensach||'Không xác định',mavitri:values.mavitri,soluong:values.soluong||1};setDanhSachSach([...danhSachSach,sachMoi]);form.resetFields(['masach','mavitri','soluong']);setTenSach('');setDanhSachViTri([]);message.success('Thêm sách thành công!',2);}catch(error){message.error('Vui lòng kiểm tra lại thông tin sách!',3);}};// Handle submit request\nconst xuLyGuiYeuCau=async()=>{if(danhSachSach.length===0){message.error('Vui lòng thêm ít nhất một cuốn sách!',3);return;}try{setDangTai(true);const values=await form.validateFields(['masinhvien','ngaymuon']);// Prepare single payload for all books\nconst duLieuGui={masinhvien:values.masinhvien,ngaymuon:values.ngaymuon.format('YYYY-MM-DD'),books:danhSachSach.map(sach=>({masach:sach.masach,mavitri:sach.mavitri,soluong:Number(sach.soluong)}))};// Send single request\nconsole.log('Payload gửi:',JSON.stringify(duLieuGui,null,2));// Debug log\nconst phanHoi=await request.post('/api/AdminRequestBorrowBook',duLieuGui,{headers:{'Content-Type':'application/json'},withCredentials:true});// Check response\nif(phanHoi.status===200){message.success('Tạo phiếu mượn sách thành công!',3);form.resetFields();setDanhSachSach([]);setTenSach('');setDanhSachViTri([]);onSuccess();onCancel();}else{throw new Error(phanHoi.data.message||'Lỗi không xác định');}}catch(error){var _error$response,_error$response$data,_error$response2,_error$response2$data;console.error('Lỗi phía frontend:',error);const errorMessage=((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.errors)||((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||error.message||'Có lỗi xảy ra!';// Handle specific book errors if returned by backend\nif(Array.isArray(errorMessage)){message.error(/*#__PURE__*/_jsxs(\"div\",{children:[\"C\\xF3 l\\u1ED7i khi m\\u01B0\\u1EE3n m\\u1ED9t s\\u1ED1 s\\xE1ch:\",/*#__PURE__*/_jsx(\"ul\",{children:errorMessage.map((err,index)=>{var _danhSachSach$find;return/*#__PURE__*/_jsxs(\"li\",{children:[\"S\\xE1ch \",((_danhSachSach$find=danhSachSach.find(s=>s.masach===err.masach))===null||_danhSachSach$find===void 0?void 0:_danhSachSach$find.tensach)||err.masach,\": \",err.message]},index);})})]}),5);}else{message.error(errorMessage,3);}}finally{setDangTai(false);}};return/*#__PURE__*/_jsx(StyledModal,{title:\"Y\\xEAu c\\u1EA7u m\\u01B0\\u1EE3n s\\xE1ch\",open:visible,onCancel:onCancel,footer:[/*#__PURE__*/_jsx(CancelButton,{onClick:onCancel,disabled:dangTai,children:\"H\\u1EE7y\"},\"cancel\"),/*#__PURE__*/_jsx(SubmitButton,{type:\"primary\",onClick:xuLyGuiYeuCau,loading:dangTai,children:\"G\\u1EEDi y\\xEAu c\\u1EA7u\"},\"submit\")],width:960,centered:true,children:/*#__PURE__*/_jsxs(StyledForm,{form:form,layout:\"vertical\",children:[/*#__PURE__*/_jsxs(FormRow,{children:[/*#__PURE__*/_jsx(Form.Item,{name:\"masinhvien\",label:\"M\\xE3 sinh vi\\xEAn\",rules:[{required:true,message:'Vui lòng chọn hoặc nhập mã sinh viên!'}],children:/*#__PURE__*/_jsx(Select,{placeholder:\"Ch\\u1ECDn ho\\u1EB7c nh\\u1EADp m\\xE3 sinh vi\\xEAn\",showSearch:true,allowClear:true,style:{borderRadius:'6px',height:'40px'},filterOption:(input,option)=>option.children.toLowerCase().includes(input.toLowerCase()),notFoundContent:danhSachDocGia.length?'Không tìm thấy mã sinh viên':'Đang tải dữ liệu...',children:danhSachDocGia.map(docgia=>/*#__PURE__*/_jsx(Option,{value:docgia.masinhvien,children:docgia.masinhvien},docgia.masinhvien))})}),/*#__PURE__*/_jsx(Form.Item,{name:\"ngaymuon\",label:\"Ng\\xE0y m\\u01B0\\u1EE3n\",rules:[{required:true,message:'Vui lòng chọn ngày mượn!'},{validator:(_,value)=>value&&value.isBefore(moment().startOf('day'))?Promise.reject('Ngày mượn không được trước ngày hiện tại!'):Promise.resolve()}],children:/*#__PURE__*/_jsx(DatePicker,{format:\"DD/MM/YYYY\",style:{width:'100%',borderRadius:'6px',height:'40px'},placeholder:\"Ch\\u1ECDn ng\\xE0y m\\u01B0\\u1EE3n\"})})]}),/*#__PURE__*/_jsxs(BookSelectionSection,{children:[/*#__PURE__*/_jsx(\"h4\",{style:{marginBottom:'16px',fontSize:'16px',fontWeight:600},children:\"Th\\xEAm s\\xE1ch\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px',alignItems:'flex-end'},children:[/*#__PURE__*/_jsx(Form.Item,{name:\"masach\",label:\"M\\xE3 s\\xE1ch\",style:{flex:1},rules:[{required:true,message:'Vui lòng chọn mã sách!'}],children:/*#__PURE__*/_jsx(Select,{placeholder:\"Ch\\u1ECDn ho\\u1EB7c t\\xECm m\\xE3 s\\xE1ch\",onChange:handleSelectMaSach,showSearch:true,style:{borderRadius:'6px',height:'40px'},filterOption:(input,option)=>option.children.toLowerCase().includes(input.toLowerCase()),notFoundContent:\"Kh\\xF4ng t\\xECm th\\u1EA5y m\\xE3 s\\xE1ch\",children:danhSachSachApi.map(sach=>/*#__PURE__*/_jsx(Option,{value:sach.masach,children:sach.masach},sach.masach))})}),/*#__PURE__*/_jsx(Form.Item,{label:\"T\\xEAn s\\xE1ch\",style:{flex:1},children:/*#__PURE__*/_jsx(Input,{value:tenSach,disabled:true,style:{width:'100%',height:'40px',borderRadius:'6px',border:'1px solid #d1d5db',padding:'0 12px',background:'#f8fafc',color:'#344054'}})}),/*#__PURE__*/_jsx(Form.Item,{name:\"mavitri\",label:\"M\\xE3 v\\u1ECB tr\\xED\",style:{flex:1},rules:[{required:true,message:'Vui lòng chọn mã vị trí!'}],children:/*#__PURE__*/_jsx(Select,{placeholder:\"Ch\\u1ECDn ho\\u1EB7c t\\xECm m\\xE3 v\\u1ECB tr\\xED\",showSearch:true,disabled:!danhSachViTri.length,style:{borderRadius:'6px',height:'40px'},filterOption:(input,option)=>option.children.toLowerCase().includes(input.toLowerCase()),notFoundContent:\"Kh\\xF4ng c\\xF3 m\\xE3 v\\u1ECB tr\\xED\",children:danhSachViTri.map(mavitri=>/*#__PURE__*/_jsx(Option,{value:mavitri,children:mavitri},mavitri))})}),/*#__PURE__*/_jsx(Form.Item,{name:\"soluong\",label:\"S\\u1ED1 l\\u01B0\\u1EE3ng\",style:{width:'100px'},initialValue:1,rules:[{required:true,message:'Vui lòng nhập số lượng!'},{type:'number',min:1,message:'Số lượng phải lớn hơn 0!'}],children:/*#__PURE__*/_jsx(InputNumber,{min:1,style:{width:'100%',borderRadius:'6px',height:'40px'}})}),/*#__PURE__*/_jsx(AddBookButton,{type:\"primary\",onClick:themSach,children:\"Th\\xEAm\"})]})]}),/*#__PURE__*/_jsx(StyledTable,{columns:cot,dataSource:danhSachSach,rowKey:(record,index)=>index,pagination:false,locale:{emptyText:'Chưa có sách nào được thêm'}})]})});};export default ModalAddHandleBook;","map":{"version":3,"names":["React","useState","useEffect","Modal","Button","Form","DatePicker","Table","InputNumber","message","Select","Input","request","moment","styled","jsx","_jsx","jsxs","_jsxs","Option","StyledModal","StyledForm","FormRow","div","BookSelectionSection","AddBookButton","CancelButton","SubmitButton","StyledTable","ModalAddHandleBook","_ref","visible","onCancel","onSuccess","form","useForm","danhSachSach","setDanhSachSach","dangTai","setDangTai","danhSachSachApi","setDanhSachSachApi","danhSachDocGia","setDanhSachDocGia","tenSach","setTenSach","danhSachViTri","setDanhSachViTri","fetchBooks","response","get","data","Array","isArray","error","fetchReaders","readers","console","log","handleSelectMaSach","value","sach","find","item","masach","tensach","viTriList","vitri","map","v","mavitri","setFieldsValue","undefined","cot","title","dataIndex","key","render","text","record","index","min","onChange","xuLyThayDoiSoLuong","style","width","borderRadius","_","__","type","danger","onClick","xoaSach","fontWeight","children","danhSachCapNhat","soluong","filter","i","themSach","values","validateFields","includes","sachMoi","resetFields","success","xuLyGuiYeuCau","length","duLieuGui","masinhvien","ngaymuon","format","books","Number","JSON","stringify","phanHoi","post","headers","withCredentials","status","Error","_error$response","_error$response$data","_error$response2","_error$response2$data","errorMessage","errors","err","_danhSachSach$find","s","open","footer","disabled","loading","centered","layout","Item","name","label","rules","required","placeholder","showSearch","allowClear","height","filterOption","input","option","toLowerCase","notFoundContent","docgia","validator","isBefore","startOf","Promise","reject","resolve","marginBottom","fontSize","display","gap","alignItems","flex","border","padding","background","color","initialValue","columns","dataSource","rowKey","pagination","locale","emptyText"],"sources":["E:/Documents/Hoc_Tap/LATN/client/src/Modal/ExtenBooks/ModalAddHandleBook.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Modal, Button, Form, DatePicker, Table, InputNumber, message, Select, Input } from 'antd';\r\nimport request from '../../config/Connect';\r\nimport moment from 'moment';\r\nimport styled from 'styled-components';\r\n\r\nconst { Option } = Select;\r\n\r\n// Styled Components (unchanged)\r\nconst StyledModal = styled(Modal)`\r\n    .ant-modal-content {\r\n        border-radius: 12px;\r\n        padding: 16px;\r\n        background: #ffffff;\r\n        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.1);\r\n    }\r\n    .ant-modal-header {\r\n        border-bottom: none;\r\n        padding: 16px 24px;\r\n    }\r\n    .ant-modal-title {\r\n        font-size: 20px;\r\n        font-weight: 600;\r\n        color: #1f2a44;\r\n    }\r\n    .ant-modal-footer {\r\n        border-top: none;\r\n        padding: 16px 24px;\r\n        display: flex;\r\n        justify-content: flex-end;\r\n        gap: 12px;\r\n    }\r\n`;\r\n\r\nconst StyledForm = styled(Form)`\r\n    .ant-form-item-label > label {\r\n        font-weight: 500;\r\n        color: #344054;\r\n    }\r\n    .ant-form-item {\r\n        margin-bottom: 16px;\r\n    }\r\n`;\r\n\r\nconst FormRow = styled.div`\r\n    display: flex;\r\n    gap: 16px;\r\n    .ant-form-item {\r\n        flex: 1;\r\n    }\r\n`;\r\n\r\nconst BookSelectionSection = styled.div`\r\n    background: #f8fafc;\r\n    padding: 20px;\r\n    border-radius: 8px;\r\n    margin-bottom: 24px;\r\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);\r\n`;\r\n\r\nconst AddBookButton = styled(Button)`\r\n    background: #2563eb;\r\n    border: none;\r\n    border-radius: 6px;\r\n    height: 40px;\r\n    font-weight: 500;\r\n    &:hover {\r\n        background: #1d4ed8;\r\n    }\r\n`;\r\n\r\nconst CancelButton = styled(Button)`\r\n    border-radius: 6px;\r\n    height: 40px;\r\n    font-weight: 500;\r\n    color: #344054;\r\n    border-color: #d1d5db;\r\n    &:hover {\r\n        border-color: #9ca3af;\r\n        color: #1f2a44;\r\n    }\r\n`;\r\n\r\nconst SubmitButton = styled(Button)`\r\n    background: #16a34a;\r\n    border: none;\r\n    border-radius: 6px;\r\n    height: 40px;\r\n    font-weight: 500;\r\n    &:hover {\r\n        background: #15803d;\r\n    }\r\n`;\r\n\r\nconst StyledTable = styled(Table)`\r\n    .ant-table {\r\n        border-radius: 8px;\r\n        overflow: hidden;\r\n    }\r\n    .ant-table-thead > tr > th {\r\n        background: #f1f5f9;\r\n        font-weight: 600;\r\n        color: #1f2a44;\r\n    }\r\n    .ant-table-tbody > tr:hover > td {\r\n        background: #f8fafc;\r\n    }\r\n`;\r\n\r\nconst ModalAddHandleBook = ({ visible, onCancel, onSuccess }) => {\r\n    const [form] = Form.useForm();\r\n    const [danhSachSach, setDanhSachSach] = useState([]);\r\n    const [dangTai, setDangTai] = useState(false);\r\n    const [danhSachSachApi, setDanhSachSachApi] = useState([]);\r\n    const [danhSachDocGia, setDanhSachDocGia] = useState([]);\r\n    const [tenSach, setTenSach] = useState('');\r\n    const [danhSachViTri, setDanhSachViTri] = useState([]);\r\n\r\n    // Fetch books and readers from API\r\n    useEffect(() => {\r\n        const fetchBooks = async () => {\r\n            try {\r\n                const response = await request.get('/api/GetBooks');\r\n                const data = Array.isArray(response.data) ? response.data : [];\r\n                setDanhSachSachApi(data);\r\n            } catch (error) {\r\n                message.error('Không thể tải danh sách sách!', 3);\r\n            }\r\n        };\r\n\r\n        const fetchReaders = async () => {\r\n            try {\r\n                const response = await request.get('/api/getAllReaders');\r\n                const readers = Array.isArray(response.data.data) ? response.data.data : [];\r\n                console.log('Danh sách độc giả:', readers); // Debug log\r\n                setDanhSachDocGia(readers);\r\n            } catch (error) {\r\n                console.error('Lỗi khi lấy danh sách độc giả:', error);\r\n                message.error('Không thể tải danh sách độc giả!', 3);\r\n            }\r\n        };\r\n\r\n        fetchBooks();\r\n        fetchReaders();\r\n    }, []);\r\n\r\n    // Handle book selection\r\n    const handleSelectMaSach = (value) => {\r\n        const sach = danhSachSachApi.find((item) => item.masach === value);\r\n        if (sach) {\r\n            setTenSach(sach.tensach || 'Không có tên sách');\r\n            const viTriList = Array.isArray(sach.vitri) ? sach.vitri.map((v) => v.mavitri) : [];\r\n            setDanhSachViTri(viTriList);\r\n            form.setFieldsValue({ mavitri: undefined });\r\n        } else {\r\n            setTenSach('');\r\n            setDanhSachViTri([]);\r\n            form.setFieldsValue({ mavitri: undefined });\r\n        }\r\n    };\r\n\r\n    // Table columns\r\n    const cot = [\r\n        {\r\n            title: 'Mã sách',\r\n            dataIndex: 'masach',\r\n            key: 'masach',\r\n        },\r\n        {\r\n            title: 'Tên sách',\r\n            dataIndex: 'tensach',\r\n            key: 'tensach',\r\n        },\r\n        {\r\n            title: 'Mã vị trí',\r\n            dataIndex: 'mavitri',\r\n            key: 'mavitri',\r\n        },\r\n        {\r\n            title: 'Số lượng',\r\n            dataIndex: 'soluong',\r\n            key: 'soluong',\r\n            render: (text, record, index) => (\r\n                <InputNumber\r\n                    min={1}\r\n                    value={text}\r\n                    onChange={(value) => xuLyThayDoiSoLuong(value, index)}\r\n                    style={{ width: '80px', borderRadius: '6px' }}\r\n                />\r\n            ),\r\n        },\r\n        {\r\n            title: 'Hành động',\r\n            key: 'action',\r\n            render: (_, __, index) => (\r\n                <Button\r\n                    type=\"link\"\r\n                    danger\r\n                    onClick={() => xoaSach(index)}\r\n                    style={{ fontWeight: 500 }}\r\n                >\r\n                    Xóa\r\n                </Button>\r\n            ),\r\n        },\r\n    ];\r\n\r\n    // Handle quantity change\r\n    const xuLyThayDoiSoLuong = (value, index) => {\r\n        const danhSachCapNhat = [...danhSachSach];\r\n        danhSachCapNhat[index].soluong = value;\r\n        setDanhSachSach(danhSachCapNhat);\r\n    };\r\n\r\n    // Remove book from list\r\n    const xoaSach = (index) => {\r\n        const danhSachCapNhat = danhSachSach.filter((_, i) => i !== index);\r\n        setDanhSachSach(danhSachCapNhat);\r\n    };\r\n\r\n    // Add book to list\r\n    const themSach = async () => {\r\n        try {\r\n            const values = await form.validateFields(['masach', 'mavitri', 'soluong']);\r\n            const sach = danhSachSachApi.find((item) => item.masach === values.masach);\r\n            if (!sach) {\r\n                message.error('Mã sách không hợp lệ!', 3);\r\n                return;\r\n            }\r\n            if (!danhSachViTri.includes(values.mavitri)) {\r\n                message.error('Mã vị trí không hợp lệ cho sách này!', 3);\r\n                return;\r\n            }\r\n            const sachMoi = {\r\n                masach: values.masach,\r\n                tensach: sach.tensach || 'Không xác định',\r\n                mavitri: values.mavitri,\r\n                soluong: values.soluong || 1,\r\n            };\r\n            setDanhSachSach([...danhSachSach, sachMoi]);\r\n            form.resetFields(['masach', 'mavitri', 'soluong']);\r\n            setTenSach('');\r\n            setDanhSachViTri([]);\r\n            message.success('Thêm sách thành công!', 2);\r\n        } catch (error) {\r\n            message.error('Vui lòng kiểm tra lại thông tin sách!', 3);\r\n        }\r\n    };\r\n\r\n    // Handle submit request\r\n    const xuLyGuiYeuCau = async () => {\r\n        if (danhSachSach.length === 0) {\r\n            message.error('Vui lòng thêm ít nhất một cuốn sách!', 3);\r\n            return;\r\n        }\r\n        try {\r\n            setDangTai(true);\r\n            const values = await form.validateFields(['masinhvien', 'ngaymuon']);\r\n\r\n            // Prepare single payload for all books\r\n            const duLieuGui = {\r\n                masinhvien: values.masinhvien,\r\n                ngaymuon: values.ngaymuon.format('YYYY-MM-DD'),\r\n                books: danhSachSach.map((sach) => ({\r\n                    masach: sach.masach,\r\n                    mavitri: sach.mavitri,\r\n                    soluong: Number(sach.soluong),\r\n                })),\r\n            };\r\n\r\n            // Send single request\r\n            console.log('Payload gửi:', JSON.stringify(duLieuGui, null, 2)); // Debug log\r\n            const phanHoi = await request.post('/api/AdminRequestBorrowBook', duLieuGui, {\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                withCredentials: true,\r\n            });\r\n\r\n            // Check response\r\n            if (phanHoi.status === 200) {\r\n                message.success('Tạo phiếu mượn sách thành công!', 3);\r\n                form.resetFields();\r\n                setDanhSachSach([]);\r\n                setTenSach('');\r\n                setDanhSachViTri([]);\r\n                onSuccess();\r\n                onCancel();\r\n            } else {\r\n                throw new Error(phanHoi.data.message || 'Lỗi không xác định');\r\n            }\r\n        } catch (error) {\r\n            console.error('Lỗi phía frontend:', error);\r\n            const errorMessage = error.response?.data?.errors || error.response?.data?.message || error.message || 'Có lỗi xảy ra!';\r\n\r\n            // Handle specific book errors if returned by backend\r\n            if (Array.isArray(errorMessage)) {\r\n                message.error(\r\n                    <div>\r\n                        Có lỗi khi mượn một số sách:\r\n                        <ul>\r\n                            {errorMessage.map((err, index) => (\r\n                                <li key={index}>\r\n                                    Sách {danhSachSach.find((s) => s.masach === err.masach)?.tensach || err.masach}: {err.message}\r\n                                </li>\r\n                            ))}\r\n                        </ul>\r\n                    </div>,\r\n                    5\r\n                );\r\n            } else {\r\n                message.error(errorMessage, 3);\r\n            }\r\n        } finally {\r\n            setDangTai(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <StyledModal\r\n            title=\"Yêu cầu mượn sách\"\r\n            open={visible}\r\n            onCancel={onCancel}\r\n            footer={[\r\n                <CancelButton key=\"cancel\" onClick={onCancel} disabled={dangTai}>\r\n                    Hủy\r\n                </CancelButton>,\r\n                <SubmitButton\r\n                    key=\"submit\"\r\n                    type=\"primary\"\r\n                    onClick={xuLyGuiYeuCau}\r\n                    loading={dangTai}\r\n                >\r\n                    Gửi yêu cầu\r\n                </SubmitButton>,\r\n            ]}\r\n            width={960}\r\n            centered\r\n        >\r\n            <StyledForm form={form} layout=\"vertical\">\r\n                <FormRow>\r\n                    <Form.Item\r\n                        name=\"masinhvien\"\r\n                        label=\"Mã sinh viên\"\r\n                        rules={[{ required: true, message: 'Vui lòng chọn hoặc nhập mã sinh viên!' }]}\r\n                    >\r\n                        <Select\r\n                            placeholder=\"Chọn hoặc nhập mã sinh viên\"\r\n                            showSearch\r\n                            allowClear\r\n                            style={{ borderRadius: '6px', height: '40px' }}\r\n                            filterOption={(input, option) =>\r\n                                option.children.toLowerCase().includes(input.toLowerCase())\r\n                            }\r\n                            notFoundContent={danhSachDocGia.length ? 'Không tìm thấy mã sinh viên' : 'Đang tải dữ liệu...'}\r\n                        >\r\n                            {danhSachDocGia.map((docgia) => (\r\n                                <Option key={docgia.masinhvien} value={docgia.masinhvien}>\r\n                                    {docgia.masinhvien}\r\n                                </Option>\r\n                            ))}\r\n                        </Select>\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                        name=\"ngaymuon\"\r\n                        label=\"Ngày mượn\"\r\n                        rules={[\r\n                            { required: true, message: 'Vui lòng chọn ngày mượn!' },\r\n                            {\r\n                                validator: (_, value) =>\r\n                                    value && value.isBefore(moment().startOf('day'))\r\n                                        ? Promise.reject('Ngày mượn không được trước ngày hiện tại!')\r\n                                        : Promise.resolve(),\r\n                            },\r\n                        ]}\r\n                    >\r\n                        <DatePicker\r\n                            format=\"DD/MM/YYYY\"\r\n                            style={{ width: '100%', borderRadius: '6px', height: '40px' }}\r\n                            placeholder=\"Chọn ngày mượn\"\r\n                        />\r\n                    </Form.Item>\r\n                </FormRow>\r\n\r\n                <BookSelectionSection>\r\n                    <h4 style={{ marginBottom: '16px', fontSize: '16px', fontWeight: 600 }}>\r\n                        Thêm sách\r\n                    </h4>\r\n                    <div style={{ display: 'flex', gap: '12px', alignItems: 'flex-end' }}>\r\n                        <Form.Item\r\n                            name=\"masach\"\r\n                            label=\"Mã sách\"\r\n                            style={{ flex: 1 }}\r\n                            rules={[{ required: true, message: 'Vui lòng chọn mã sách!' }]}\r\n                        >\r\n                            <Select\r\n                                placeholder=\"Chọn hoặc tìm mã sách\"\r\n                                onChange={handleSelectMaSach}\r\n                                showSearch\r\n                                style={{ borderRadius: '6px', height: '40px' }}\r\n                                filterOption={(input, option) =>\r\n                                    option.children.toLowerCase().includes(input.toLowerCase())\r\n                                }\r\n                                notFoundContent=\"Không tìm thấy mã sách\"\r\n                            >\r\n                                {danhSachSachApi.map((sach) => (\r\n                                    <Option key={sach.masach} value={sach.masach}>\r\n                                        {sach.masach}\r\n                                    </Option>\r\n                                ))}\r\n                            </Select>\r\n                        </Form.Item>\r\n                        <Form.Item label=\"Tên sách\" style={{ flex: 1 }}>\r\n                            <Input\r\n                                value={tenSach}\r\n                                disabled\r\n                                style={{\r\n                                    width: '100%',\r\n                                    height: '40px',\r\n                                    borderRadius: '6px',\r\n                                    border: '1px solid #d1d5db',\r\n                                    padding: '0 12px',\r\n                                    background: '#f8fafc',\r\n                                    color: '#344054',\r\n                                }}\r\n                            />\r\n                        </Form.Item>\r\n                        <Form.Item\r\n                            name=\"mavitri\"\r\n                            label=\"Mã vị trí\"\r\n                            style={{ flex: 1 }}\r\n                            rules={[{ required: true, message: 'Vui lòng chọn mã vị trí!' }]}\r\n                        >\r\n                            <Select\r\n                                placeholder=\"Chọn hoặc tìm mã vị trí\"\r\n                                showSearch\r\n                                disabled={!danhSachViTri.length}\r\n                                style={{ borderRadius: '6px', height: '40px' }}\r\n                                filterOption={(input, option) =>\r\n                                    option.children.toLowerCase().includes(input.toLowerCase())\r\n                                }\r\n                                notFoundContent=\"Không có mã vị trí\"\r\n                            >\r\n                                {danhSachViTri.map((mavitri) => (\r\n                                    <Option key={mavitri} value={mavitri}>\r\n                                        {mavitri}\r\n                                    </Option>\r\n                                ))}\r\n                            </Select>\r\n                        </Form.Item>\r\n                        <Form.Item\r\n                            name=\"soluong\"\r\n                            label=\"Số lượng\"\r\n                            style={{ width: '100px' }}\r\n                            initialValue={1}\r\n                            rules={[\r\n                                { required: true, message: 'Vui lòng nhập số lượng!' },\r\n                                { type: 'number', min: 1, message: 'Số lượng phải lớn hơn 0!' },\r\n                            ]}\r\n                        >\r\n                            <InputNumber\r\n                                min={1}\r\n                                style={{ width: '100%', borderRadius: '6px', height: '40px' }}\r\n                            />\r\n                        </Form.Item>\r\n                        <AddBookButton type=\"primary\" onClick={themSach}>\r\n                            Thêm\r\n                        </AddBookButton>\r\n                    </div>\r\n                </BookSelectionSection>\r\n\r\n                <StyledTable\r\n                    columns={cot}\r\n                    dataSource={danhSachSach}\r\n                    rowKey={(record, index) => index}\r\n                    pagination={false}\r\n                    locale={{ emptyText: 'Chưa có sách nào được thêm' }}\r\n                />\r\n            </StyledForm>\r\n        </StyledModal>\r\n    );\r\n};\r\n\r\nexport default ModalAddHandleBook;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}