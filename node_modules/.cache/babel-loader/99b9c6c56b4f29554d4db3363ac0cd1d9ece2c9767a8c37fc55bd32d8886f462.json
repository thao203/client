{"ast":null,"code":"import classNames from'classnames/bind';import styles from'./HistoryBook.module.scss';import Header from'../../Header/Header';import MenuLeft from'../../MenuLeft/MenuLeft';import Footer from'../../Footer/Footer';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{faCheck,faSpinner,faBook}from'@fortawesome/free-solid-svg-icons';import{useEffect,useState}from'react';import request from'../../../../../config/Connect';import{jwtDecode}from'jwt-decode';import{ToastContainer,toast}from'react-toastify';import'react-toastify/dist/ReactToastify.css';import'bootstrap/dist/css/bootstrap.min.css';import{Chip,Fade,Paper,styled,Table,TableBody,TableCell,TableContainer,TableHead,TableRow,Typography,Modal,Box,Button as MuiButton}from'@mui/material';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const cx=classNames.bind(styles);// Toast configuration\nconst toastOptions={position:\"top-right\",autoClose:1000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined};function HistoryBook(){const token=document.cookie;const[dataBooks,setDataBooks]=useState([]);const[masinhvien,setMasinhvien]=useState('');const[selectedBooks,setSelectedBooks]=useState([]);const[selectedMaphieumuon,setSelectedMaphieumuon]=useState('');const[openModal,setOpenModal]=useState(false);const StyledTableContainer=styled(TableContainer)(_ref=>{let{theme}=_ref;return{borderRadius:'12px',boxShadow:'0 8px 32px rgba(0, 0, 0, 0.08)',overflowX:'auto',background:'linear-gradient(145deg, #ffffff, #f8f9fa)',[theme.breakpoints.down('sm')]:{minWidth:'100%'}};});const StyledTableHead=styled(TableHead)(_ref2=>{let{theme}=_ref2;return{background:'linear-gradient(90deg, #1976d2, #42a5f5)','& th':{color:'#fff',fontWeight:600,padding:theme.spacing(2),borderBottom:'none',fontSize:{xs:'0.9rem',sm:'1rem',md:'1.2rem'},whiteSpace:'nowrap'}};});const StyledTableRow=styled(TableRow)(_ref3=>{let{theme}=_ref3;return{'&:hover':{backgroundColor:theme.palette.grey[100],transform:'translateY(-2px)',transition:'all 0.2s ease-in-out'},transition:'all 0.2s ease-in-out'};});const StyledTableCell=styled(TableCell)(_ref4=>{let{theme}=_ref4;return{padding:theme.spacing(1.5),fontSize:{xs:'0.7rem',sm:'0.875rem'},whiteSpace:'nowrap'};});const ModalBox=styled(Box)(_ref5=>{let{theme}=_ref5;return{position:'absolute',top:'50%',left:'50%',transform:'translate(-50%, -50%)',width:'95%',maxWidth:1200,backgroundColor:theme.palette.background.paper,boxShadow:24,padding:theme.spacing(6),borderRadius:16,maxHeight:'90vh',overflowY:'auto'};});useEffect(()=>{document.title='Lịch sử mượn';},[]);const formatDate=dateString=>{if(!dateString)return'N/A';return new Date(dateString).toLocaleDateString('vi-VN');};// Hàm tính số ngày quá hạn\nconst calculateOverdueDays=function(dueDate){let isReturned=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let savedOverdueDays=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;let returnDate=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;if(isReturned&&savedOverdueDays!==undefined){return savedOverdueDays;// Sử dụng số ngày quá hạn đã lưu\n}if(!dueDate||isReturned)return 0;try{const today=new Date();const due=new Date(dueDate);today.setHours(0,0,0,0);due.setHours(0,0,0,0);const diffTime=today.getTime()-due.getTime();const diffDays=Math.floor(diffTime/(1000*60*60*24));return diffDays>0?diffDays:0;}catch{return 0;}};const handleExtendAllBooks=async maphieumuon=>{try{const borrowingSlip=dataBooks.find(item=>item.maphieumuon===maphieumuon);if(!borrowingSlip){toast.error('Không tìm thấy phiếu mượn!',toastOptions);return;}const booksToExtend=borrowingSlip.books.filter(book=>!book.tinhtrang&&!book.giahan);if(booksToExtend.length===0){toast.info('Không có sách nào cần gia hạn!',toastOptions);return;}const extensionPromises=booksToExtend.map(book=>request.post('/api/ExtendBorrowing',{maphieumuon,masach:book.masach}));const responses=await Promise.all(extensionPromises);const allSuccessful=responses.every(response=>response.status===200);if(allSuccessful){toast.success('Gia hạn tất cả sách thành công!',toastOptions);fetchDataAndUpdate();}else{toast.error('Có lỗi xảy ra khi gia hạn một số sách!',toastOptions);}}catch(error){var _error$response,_error$response$data;console.error('Lỗi khi gia hạn tất cả sách:',error);toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Đã xảy ra lỗi khi gia hạn!',toastOptions);}};const handleExtendBorrowing=async(maphieumuon,masach)=>{try{const response=await request.post('/api/ExtendBorrowing',{maphieumuon,masach});toast.success(response.data.message,toastOptions);if(response.status===200){setSelectedBooks(prevBooks=>prevBooks.map(book=>book.masach===masach?{...book,giahan:true,newngayhentra:response.data.newngayhentra||new Date().toISOString()}:book));fetchDataAndUpdate();}}catch(error){var _error$response2,_error$response2$data;console.error('Lỗi khi gia hạn sách:',error);toast.error(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Đã xảy ra lỗi khi gia hạn!',toastOptions);}};const fetchDataAndUpdate=async()=>{if(token&&masinhvien){try{const response=await request.get('/api/GetBorrowsByStudent',{params:{masinhvien}});const data=response.data.data||[];// Tính toán overdueDays cho sách đã trả\nconst updatedData=data.map(record=>({...record,books:record.books.map(book=>{if(book.tinhtrang&&book.ngaytra){const dueDate=new Date(book.ngayhentra||record.ngayhentra);const returnDate=new Date(book.ngaytra);dueDate.setHours(0,0,0,0);returnDate.setHours(0,0,0,0);const diffTime=returnDate.getTime()-dueDate.getTime();const overdueDays=Math.floor(diffTime/(1000*60*60*24));return{...book,overdueDays:overdueDays>0?overdueDays:0};}return book;})}));setDataBooks(updatedData);}catch(error){setDataBooks([]);toast.error('Lỗi khi tải dữ liệu lịch sử mượn!',toastOptions);}}};useEffect(()=>{if(token){try{const decoded=jwtDecode(token);setMasinhvien(decoded.masinhvien);}catch(error){console.error('Lỗi khi giải mã token:',error);}}},[token]);useEffect(()=>{fetchDataAndUpdate();},[masinhvien,token]);const handleOpenModal=(books,maphieumuon)=>{setSelectedBooks(books);setSelectedMaphieumuon(maphieumuon);setOpenModal(true);};const handleCloseModal=()=>{setOpenModal(false);setSelectedBooks([]);setSelectedMaphieumuon('');};return/*#__PURE__*/_jsxs(\"div\",{className:cx('wrapper'),children:[/*#__PURE__*/_jsx(\"header\",{className:cx('header'),children:/*#__PURE__*/_jsx(Header,{})}),/*#__PURE__*/_jsxs(\"div\",{className:cx('main-container'),children:[/*#__PURE__*/_jsx(\"aside\",{className:cx('menu-left'),children:/*#__PURE__*/_jsx(MenuLeft,{})}),/*#__PURE__*/_jsx(\"main\",{className:cx('content'),children:/*#__PURE__*/_jsx(\"div\",{className:\"container mt-4\",children:/*#__PURE__*/_jsx(StyledTableContainer,{component:Paper,children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(StyledTableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(StyledTableCell,{children:\"M\\xE3 Phi\\u1EBFu\"}),/*#__PURE__*/_jsx(StyledTableCell,{children:\"Ng\\xE0y M\\u01B0\\u1EE3n\"}),/*#__PURE__*/_jsx(StyledTableCell,{children:\"Ng\\xE0y H\\u1EB9n Tr\\u1EA3\"}),/*#__PURE__*/_jsx(StyledTableCell,{children:\"Qu\\xE1 H\\u1EA1n\"}),/*#__PURE__*/_jsx(StyledTableCell,{children:\"T\\xECnh Tr\\u1EA1ng\"}),/*#__PURE__*/_jsx(StyledTableCell,{children:\"H\\xE0nh \\u0110\\u1ED9ng\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:dataBooks.map((item,index)=>{const hasOverdue=item.books.some(book=>book.tinhtrang?book.overdueDays>0:calculateOverdueDays(book.ngayhentra||item.ngayhentra,book.tinhtrang)>0);const maxOverdueDays=Math.max(...item.books.map(book=>book.tinhtrang?book.overdueDays:calculateOverdueDays(book.ngayhentra||item.ngayhentra,book.tinhtrang)),0);return/*#__PURE__*/_jsx(Fade,{in:true,timeout:400+index*100,children:/*#__PURE__*/_jsxs(StyledTableRow,{children:[/*#__PURE__*/_jsx(StyledTableCell,{children:(item===null||item===void 0?void 0:item.maphieumuon)||'N/A'}),/*#__PURE__*/_jsx(StyledTableCell,{children:formatDate(item===null||item===void 0?void 0:item.ngaymuon)}),/*#__PURE__*/_jsx(StyledTableCell,{children:formatDate(item===null||item===void 0?void 0:item.ngayhentra)}),/*#__PURE__*/_jsx(StyledTableCell,{children:hasOverdue?/*#__PURE__*/_jsx(Chip,{label:`${maxOverdueDays} ngày`,color:\"error\",size:\"small\"}):'Không'}),/*#__PURE__*/_jsx(StyledTableCell,{children:item.books.every(book=>book.tinhtrang)?/*#__PURE__*/_jsx(Chip,{icon:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCheck}),label:\"\\u0110\\xE3 tr\\u1EA3\",color:\"success\",size:\"small\"}):/*#__PURE__*/_jsx(Chip,{icon:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faSpinner,className:\"fa-spin\"}),label:\"\\u0110ang m\\u01B0\\u1EE3n\",color:\"warning\",size:\"small\"})}),/*#__PURE__*/_jsx(StyledTableCell,{children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'8px'},children:[!item.books.every(book=>book.tinhtrang)&&!item.books.every(book=>book.giahan)?/*#__PURE__*/_jsx(MuiButton,{variant:\"contained\",size:\"small\",onClick:()=>handleExtendAllBooks(item===null||item===void 0?void 0:item.maphieumuon),sx:{borderRadius:20,textTransform:'none',background:'linear-gradient(45deg, #1976d2, #42a5f5)',fontSize:{xs:'0.7rem',sm:'0.875rem'},padding:{xs:'4px 8px',sm:'6px 12px'},'&:hover':{transform:'scale(1.05)',transition:'all 0.2s'}},children:\"Gia H\\u1EA1n T\\u1EA5t C\\u1EA3\"}):item.books.some(book=>book.giahan)&&!item.books.every(book=>book.tinhtrang)?/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{fontSize:{xs:'0.7rem',sm:'0.875rem'}},children:\"\\u0110\\xE3 gia h\\u1EA1n\"}):null,/*#__PURE__*/_jsxs(MuiButton,{variant:\"outlined\",size:\"small\",onClick:()=>handleOpenModal(item.books,item.maphieumuon),sx:{borderRadius:20,textTransform:'none',fontSize:{xs:'0.7rem',sm:'0.875rem'},padding:{xs:'4px 8px',sm:'6px 12px'},'&:hover':{transform:'scale(1.05)',transition:'all 0.2s'}},children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faBook,style:{marginRight:4}}),\"Chi ti\\u1EBFt\"]})]})})]})},index);})})]})})})})]}),/*#__PURE__*/_jsx(\"footer\",{className:cx('footer'),children:/*#__PURE__*/_jsx(Footer,{})}),/*#__PURE__*/_jsx(Modal,{open:openModal,onClose:handleCloseModal,children:/*#__PURE__*/_jsxs(ModalBox,{children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",gutterBottom:true,children:[\"Chi ti\\u1EBFt s\\xE1ch m\\u01B0\\u1EE3n (Phi\\u1EBFu: \",selectedMaphieumuon,\")\"]}),/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(StyledTableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(StyledTableCell,{children:\"M\\xE3 S\\xE1ch\"}),/*#__PURE__*/_jsx(StyledTableCell,{children:\"T\\xEAn S\\xE1ch\"}),/*#__PURE__*/_jsx(StyledTableCell,{children:\"V\\u1ECB Tr\\xED\"}),/*#__PURE__*/_jsx(StyledTableCell,{children:\"S\\u1ED1 L\\u01B0\\u1EE3ng\"}),/*#__PURE__*/_jsx(StyledTableCell,{children:\"Qu\\xE1 H\\u1EA1n\"}),/*#__PURE__*/_jsx(StyledTableCell,{children:\"Ng\\xE0y Tr\\u1EA3\"}),/*#__PURE__*/_jsx(StyledTableCell,{children:\"Ng\\xE0y H\\u1EB9n Tr\\u1EA3 M\\u1EDBi\"}),/*#__PURE__*/_jsx(StyledTableCell,{children:\"T\\xECnh Tr\\u1EA1ng\"}),/*#__PURE__*/_jsx(StyledTableCell,{children:\"H\\xE0nh \\u0110\\u1ED9ng\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:selectedBooks.map((book,index)=>{var _dataBooks$find;const dueDate=book.ngayhentra||((_dataBooks$find=dataBooks.find(item=>item.maphieumuon===selectedMaphieumuon))===null||_dataBooks$find===void 0?void 0:_dataBooks$find.ngayhentra);const overdueDays=calculateOverdueDays(dueDate,book.tinhtrang,book.overdueDays);return/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(StyledTableCell,{children:book.masach}),/*#__PURE__*/_jsx(StyledTableCell,{children:book.tensach}),/*#__PURE__*/_jsx(StyledTableCell,{children:book.mavitri}),/*#__PURE__*/_jsx(StyledTableCell,{children:book.soluong}),/*#__PURE__*/_jsx(StyledTableCell,{children:overdueDays>0?/*#__PURE__*/_jsx(Chip,{label:`${overdueDays} ngày`,color:\"error\",size:\"small\"}):'Không'}),/*#__PURE__*/_jsx(StyledTableCell,{children:book.ngaytra?formatDate(book.ngaytra):'Chưa trả'}),/*#__PURE__*/_jsx(StyledTableCell,{children:book.giahan&&book.newngayhentra?formatDate(book.newngayhentra):'N/A'}),/*#__PURE__*/_jsx(StyledTableCell,{children:book.tinhtrang?/*#__PURE__*/_jsx(Chip,{icon:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCheck}),label:\"\\u0110\\xE3 tr\\u1EA3\",color:\"success\",size:\"small\"}):/*#__PURE__*/_jsx(Chip,{icon:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faSpinner,className:\"fa-spin\"}),label:\"\\u0110ang m\\u01B0\\u1EE3n\",color:\"warning\",size:\"small\"})}),/*#__PURE__*/_jsx(StyledTableCell,{children:!book.tinhtrang&&!book.giahan?/*#__PURE__*/_jsx(MuiButton,{variant:\"contained\",size:\"small\",onClick:()=>handleExtendBorrowing(selectedMaphieumuon,book.masach),sx:{borderRadius:20,textTransform:'none',background:'linear-gradient(45deg, #1976d2, #42a5f5)',fontSize:{xs:'0.7rem',sm:'0.875rem'},padding:{xs:'4px 8px',sm:'6px 12px'},'&:hover':{transform:'scale(1.05)',transition:'all 0.2s'}},children:\"Gia H\\u1EA1n\"}):book.giahan&&!book.tinhtrang?/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{fontSize:{xs:'0.7rem',sm:'0.875rem'}},children:\"\\u0110\\xE3 gia h\\u1EA1n\"}):null})]},index);})})]}),/*#__PURE__*/_jsx(MuiButton,{variant:\"contained\",onClick:handleCloseModal,sx:{mt:2,float:'right'},children:\"\\u0110\\xF3ng\"})]})}),/*#__PURE__*/_jsx(ToastContainer,{...toastOptions})]});}export default HistoryBook;","map":{"version":3,"names":["classNames","styles","Header","MenuLeft","Footer","FontAwesomeIcon","faCheck","faSpinner","faBook","useEffect","useState","request","jwtDecode","ToastContainer","toast","Chip","Fade","Paper","styled","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Typography","Modal","Box","Button","MuiButton","jsx","_jsx","jsxs","_jsxs","cx","bind","toastOptions","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","HistoryBook","token","document","cookie","dataBooks","setDataBooks","masinhvien","setMasinhvien","selectedBooks","setSelectedBooks","selectedMaphieumuon","setSelectedMaphieumuon","openModal","setOpenModal","StyledTableContainer","_ref","theme","borderRadius","boxShadow","overflowX","background","breakpoints","down","minWidth","StyledTableHead","_ref2","color","fontWeight","padding","spacing","borderBottom","fontSize","xs","sm","md","whiteSpace","StyledTableRow","_ref3","backgroundColor","palette","grey","transform","transition","StyledTableCell","_ref4","ModalBox","_ref5","top","left","width","maxWidth","paper","maxHeight","overflowY","title","formatDate","dateString","Date","toLocaleDateString","calculateOverdueDays","dueDate","isReturned","arguments","length","savedOverdueDays","returnDate","today","due","setHours","diffTime","getTime","diffDays","Math","floor","handleExtendAllBooks","maphieumuon","borrowingSlip","find","item","error","booksToExtend","books","filter","book","tinhtrang","giahan","info","extensionPromises","map","post","masach","responses","Promise","all","allSuccessful","every","response","status","success","fetchDataAndUpdate","_error$response","_error$response$data","console","data","message","handleExtendBorrowing","prevBooks","newngayhentra","toISOString","_error$response2","_error$response2$data","get","params","updatedData","record","ngaytra","ngayhentra","overdueDays","decoded","handleOpenModal","handleCloseModal","className","children","component","index","hasOverdue","some","maxOverdueDays","max","in","timeout","ngaymuon","label","size","icon","style","display","gap","variant","onClick","sx","textTransform","marginRight","open","onClose","gutterBottom","_dataBooks$find","tensach","mavitri","soluong","mt","float"],"sources":["E:/Documents/Hoc_Tap/LATN/client/src/Page/HomePage/Layouts/Main/HistoryBook/HistoryBook.js"],"sourcesContent":["import classNames from 'classnames/bind';\r\nimport styles from './HistoryBook.module.scss';\r\nimport Header from '../../Header/Header';\r\nimport MenuLeft from '../../MenuLeft/MenuLeft';\r\nimport Footer from '../../Footer/Footer';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { faCheck, faSpinner, faBook } from '@fortawesome/free-solid-svg-icons';\r\nimport { useEffect, useState } from 'react';\r\nimport request from '../../../../../config/Connect';\r\nimport { jwtDecode } from 'jwt-decode';\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport {\r\n    Chip,\r\n    Fade,\r\n    Paper,\r\n    styled,\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableContainer,\r\n    TableHead,\r\n    TableRow,\r\n    Typography,\r\n    Modal,\r\n    Box,\r\n    Button as MuiButton,\r\n} from '@mui/material';\r\n\r\nconst cx = classNames.bind(styles);\r\n\r\n// Toast configuration\r\nconst toastOptions = {\r\n    position: \"top-right\",\r\n    autoClose: 1000,\r\n    hideProgressBar: false,\r\n    closeOnClick: true,\r\n    pauseOnHover: true,\r\n    draggable: true,\r\n    progress: undefined,\r\n};\r\n\r\nfunction HistoryBook() {\r\n    const token = document.cookie;\r\n    const [dataBooks, setDataBooks] = useState([]);\r\n    const [masinhvien, setMasinhvien] = useState('');\r\n    const [selectedBooks, setSelectedBooks] = useState([]);\r\n    const [selectedMaphieumuon, setSelectedMaphieumuon] = useState('');\r\n    const [openModal, setOpenModal] = useState(false);\r\n\r\n    const StyledTableContainer = styled(TableContainer)(({ theme }) => ({\r\n        borderRadius: '12px',\r\n        boxShadow: '0 8px 32px rgba(0, 0, 0, 0.08)',\r\n        overflowX: 'auto',\r\n        background: 'linear-gradient(145deg, #ffffff, #f8f9fa)',\r\n        [theme.breakpoints.down('sm')]: {\r\n            minWidth: '100%',\r\n        },\r\n    }));\r\n\r\n    const StyledTableHead = styled(TableHead)(({ theme }) => ({\r\n        background: 'linear-gradient(90deg, #1976d2, #42a5f5)',\r\n        '& th': {\r\n            color: '#fff',\r\n            fontWeight: 600,\r\n            padding: theme.spacing(2),\r\n            borderBottom: 'none',\r\n            fontSize: { xs: '0.9rem', sm: '1rem', md: '1.2rem' },\r\n            whiteSpace: 'nowrap',\r\n        },\r\n    }));\r\n\r\n    const StyledTableRow = styled(TableRow)(({ theme }) => ({\r\n        '&:hover': {\r\n            backgroundColor: theme.palette.grey[100],\r\n            transform: 'translateY(-2px)',\r\n            transition: 'all 0.2s ease-in-out',\r\n        },\r\n        transition: 'all 0.2s ease-in-out',\r\n    }));\r\n\r\n    const StyledTableCell = styled(TableCell)(({ theme }) => ({\r\n        padding: theme.spacing(1.5),\r\n        fontSize: { xs: '0.7rem', sm: '0.875rem' },\r\n        whiteSpace: 'nowrap',\r\n    }));\r\n\r\n    const ModalBox = styled(Box)(({ theme }) => ({\r\n        position: 'absolute',\r\n        top: '50%',\r\n        left: '50%',\r\n        transform: 'translate(-50%, -50%)',\r\n        width: '95%',\r\n        maxWidth: 1200,\r\n        backgroundColor: theme.palette.background.paper,\r\n        boxShadow: 24,\r\n        padding: theme.spacing(6),\r\n        borderRadius: 16,\r\n        maxHeight: '90vh',\r\n        overflowY: 'auto',\r\n    }));\r\n\r\n    useEffect(() => {\r\n        document.title = 'Lịch sử mượn';\r\n    }, []);\r\n\r\n    const formatDate = (dateString) => {\r\n        if (!dateString) return 'N/A';\r\n        return new Date(dateString).toLocaleDateString('vi-VN');\r\n    };\r\n\r\n    // Hàm tính số ngày quá hạn\r\n    const calculateOverdueDays = (dueDate, isReturned = false, savedOverdueDays = 0, returnDate = null) => {\r\n        if (isReturned && savedOverdueDays !== undefined) {\r\n            return savedOverdueDays; // Sử dụng số ngày quá hạn đã lưu\r\n        }\r\n        if (!dueDate || isReturned) return 0;\r\n        try {\r\n            const today = new Date();\r\n            const due = new Date(dueDate);\r\n            today.setHours(0, 0, 0, 0);\r\n            due.setHours(0, 0, 0, 0);\r\n            const diffTime = today.getTime() - due.getTime();\r\n            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\r\n            return diffDays > 0 ? diffDays : 0;\r\n        } catch {\r\n            return 0;\r\n        }\r\n    };\r\n\r\n    const handleExtendAllBooks = async (maphieumuon) => {\r\n        try {\r\n            const borrowingSlip = dataBooks.find(item => item.maphieumuon === maphieumuon);\r\n            if (!borrowingSlip) {\r\n                toast.error('Không tìm thấy phiếu mượn!', toastOptions);\r\n                return;\r\n            }\r\n\r\n            const booksToExtend = borrowingSlip.books.filter(\r\n                book => !book.tinhtrang && !book.giahan\r\n            );\r\n\r\n            if (booksToExtend.length === 0) {\r\n                toast.info('Không có sách nào cần gia hạn!', toastOptions);\r\n                return;\r\n            }\r\n\r\n            const extensionPromises = booksToExtend.map(book =>\r\n                request.post('/api/ExtendBorrowing', { maphieumuon, masach: book.masach })\r\n            );\r\n\r\n            const responses = await Promise.all(extensionPromises);\r\n\r\n            const allSuccessful = responses.every(response => response.status === 200);\r\n            if (allSuccessful) {\r\n                toast.success('Gia hạn tất cả sách thành công!', toastOptions);\r\n                fetchDataAndUpdate();\r\n            } else {\r\n                toast.error('Có lỗi xảy ra khi gia hạn một số sách!', toastOptions);\r\n            }\r\n        } catch (error) {\r\n            console.error('Lỗi khi gia hạn tất cả sách:', error);\r\n            toast.error(error.response?.data?.message || 'Đã xảy ra lỗi khi gia hạn!', toastOptions);\r\n        }\r\n    };\r\n\r\n    const handleExtendBorrowing = async (maphieumuon, masach) => {\r\n        try {\r\n            const response = await request.post('/api/ExtendBorrowing', { maphieumuon, masach });\r\n            toast.success(response.data.message, toastOptions);\r\n            if (response.status === 200) {\r\n                setSelectedBooks(prevBooks =>\r\n                    prevBooks.map(book =>\r\n                        book.masach === masach\r\n                            ? {\r\n                                ...book,\r\n                                giahan: true,\r\n                                newngayhentra: response.data.newngayhentra || new Date().toISOString(),\r\n                            }\r\n                            : book\r\n                    )\r\n                );\r\n                fetchDataAndUpdate();\r\n            }\r\n        } catch (error) {\r\n            console.error('Lỗi khi gia hạn sách:', error);\r\n            toast.error(error.response?.data?.message || 'Đã xảy ra lỗi khi gia hạn!', toastOptions);\r\n        }\r\n    };\r\n\r\n    const fetchDataAndUpdate = async () => {\r\n        if (token && masinhvien) {\r\n            try {\r\n                const response = await request.get('/api/GetBorrowsByStudent', {\r\n                    params: { masinhvien },\r\n                });\r\n                const data = response.data.data || [];\r\n                // Tính toán overdueDays cho sách đã trả\r\n                const updatedData = data.map((record) => ({\r\n                    ...record,\r\n                    books: record.books.map((book) => {\r\n                        if (book.tinhtrang && book.ngaytra) {\r\n                            const dueDate = new Date(book.ngayhentra || record.ngayhentra);\r\n                            const returnDate = new Date(book.ngaytra);\r\n                            dueDate.setHours(0, 0, 0, 0);\r\n                            returnDate.setHours(0, 0, 0, 0);\r\n                            const diffTime = returnDate.getTime() - dueDate.getTime();\r\n                            const overdueDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\r\n                            return {\r\n                                ...book,\r\n                                overdueDays: overdueDays > 0 ? overdueDays : 0,\r\n                            };\r\n                        }\r\n                        return book;\r\n                    }),\r\n                }));\r\n                setDataBooks(updatedData);\r\n            } catch (error) {\r\n                setDataBooks([]);\r\n                toast.error('Lỗi khi tải dữ liệu lịch sử mượn!', toastOptions);\r\n            }\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (token) {\r\n            try {\r\n                const decoded = jwtDecode(token);\r\n                setMasinhvien(decoded.masinhvien);\r\n            } catch (error) {\r\n                console.error('Lỗi khi giải mã token:', error);\r\n            }\r\n        }\r\n    }, [token]);\r\n\r\n    useEffect(() => {\r\n        fetchDataAndUpdate();\r\n    }, [masinhvien, token]);\r\n\r\n    const handleOpenModal = (books, maphieumuon) => {\r\n        setSelectedBooks(books);\r\n        setSelectedMaphieumuon(maphieumuon);\r\n        setOpenModal(true);\r\n    };\r\n\r\n    const handleCloseModal = () => {\r\n        setOpenModal(false);\r\n        setSelectedBooks([]);\r\n        setSelectedMaphieumuon('');\r\n    };\r\n\r\n    return (\r\n        <div className={cx('wrapper')}>\r\n            <header className={cx('header')}>\r\n                <Header />\r\n            </header>\r\n\r\n            <div className={cx('main-container')}>\r\n                <aside className={cx('menu-left')}>\r\n                    <MenuLeft />\r\n                </aside>\r\n\r\n                <main className={cx('content')}>\r\n                    <div className=\"container mt-4\">\r\n                        <StyledTableContainer component={Paper}>\r\n                            <Table>\r\n                                <StyledTableHead>\r\n                                    <TableRow>\r\n                                        <StyledTableCell>Mã Phiếu</StyledTableCell>\r\n                                        <StyledTableCell>Ngày Mượn</StyledTableCell>\r\n                                        <StyledTableCell>Ngày Hẹn Trả</StyledTableCell>\r\n                                        <StyledTableCell>Quá Hạn</StyledTableCell>\r\n                                        <StyledTableCell>Tình Trạng</StyledTableCell>\r\n                                        <StyledTableCell>Hành Động</StyledTableCell>\r\n                                    </TableRow>\r\n                                </StyledTableHead>\r\n                                <TableBody>\r\n                                    {dataBooks.map((item, index) => {\r\n                                        const hasOverdue = item.books.some(book =>\r\n                                            book.tinhtrang\r\n                                                ? book.overdueDays > 0\r\n                                                : calculateOverdueDays(book.ngayhentra || item.ngayhentra, book.tinhtrang) > 0\r\n                                        );\r\n                                        const maxOverdueDays = Math.max(\r\n                                            ...item.books.map(book =>\r\n                                                book.tinhtrang\r\n                                                    ? book.overdueDays\r\n                                                    : calculateOverdueDays(book.ngayhentra || item.ngayhentra, book.tinhtrang)\r\n                                            ),\r\n                                            0\r\n                                        );\r\n\r\n                                        return (\r\n                                            <Fade in timeout={400 + index * 100} key={index}>\r\n                                                <StyledTableRow>\r\n                                                    <StyledTableCell>{item?.maphieumuon || 'N/A'}</StyledTableCell>\r\n                                                    <StyledTableCell>{formatDate(item?.ngaymuon)}</StyledTableCell>\r\n                                                    <StyledTableCell>{formatDate(item?.ngayhentra)}</StyledTableCell>\r\n                                                    <StyledTableCell>\r\n                                                        {hasOverdue ? (\r\n                                                            <Chip\r\n                                                                label={`${maxOverdueDays} ngày`}\r\n                                                                color=\"error\"\r\n                                                                size=\"small\"\r\n                                                            />\r\n                                                        ) : (\r\n                                                            'Không'\r\n                                                        )}\r\n                                                    </StyledTableCell>\r\n                                                    <StyledTableCell>\r\n                                                        {item.books.every(book => book.tinhtrang) ? (\r\n                                                            <Chip\r\n                                                                icon={<FontAwesomeIcon icon={faCheck} />}\r\n                                                                label=\"Đã trả\"\r\n                                                                color=\"success\"\r\n                                                                size=\"small\"\r\n                                                            />\r\n                                                        ) : (\r\n                                                            <Chip\r\n                                                                icon={\r\n                                                                    <FontAwesomeIcon\r\n                                                                        icon={faSpinner}\r\n                                                                        className=\"fa-spin\"\r\n                                                                    />\r\n                                                                }\r\n                                                                label=\"Đang mượn\"\r\n                                                                color=\"warning\"\r\n                                                                size=\"small\"\r\n                                                            />\r\n                                                        )}\r\n                                                    </StyledTableCell>\r\n                                                    <StyledTableCell>\r\n                                                        <div style={{ display: 'flex', gap: '8px' }}>\r\n                                                            {!item.books.every(book => book.tinhtrang) &&\r\n                                                            !item.books.every(book => book.giahan) ? (\r\n                                                                <MuiButton\r\n                                                                    variant=\"contained\"\r\n                                                                    size=\"small\"\r\n                                                                    onClick={() =>\r\n                                                                        handleExtendAllBooks(item?.maphieumuon)\r\n                                                                    }\r\n                                                                    sx={{\r\n                                                                        borderRadius: 20,\r\n                                                                        textTransform: 'none',\r\n                                                                        background:\r\n                                                                            'linear-gradient(45deg, #1976d2, #42a5f5)',\r\n                                                                        fontSize: { xs: '0.7rem', sm: '0.875rem' },\r\n                                                                        padding: { xs: '4px 8px', sm: '6px 12px' },\r\n                                                                        '&:hover': {\r\n                                                                            transform: 'scale(1.05)',\r\n                                                                            transition: 'all 0.2s',\r\n                                                                        },\r\n                                                                    }}\r\n                                                                >\r\n                                                                    Gia Hạn Tất Cả\r\n                                                                </MuiButton>\r\n                                                            ) : item.books.some(book => book.giahan) &&\r\n                                                            !item.books.every(book => book.tinhtrang) ? (\r\n                                                                <Typography\r\n                                                                    variant=\"body2\"\r\n                                                                    color=\"text.secondary\"\r\n                                                                    sx={{\r\n                                                                        fontSize: { xs: '0.7rem', sm: '0.875rem' },\r\n                                                                    }}\r\n                                                                >\r\n                                                                    Đã gia hạn\r\n                                                                </Typography>\r\n                                                            ) : null}\r\n                                                            <MuiButton\r\n                                                                variant=\"outlined\"\r\n                                                                size=\"small\"\r\n                                                                onClick={() =>\r\n                                                                    handleOpenModal(item.books, item.maphieumuon)\r\n                                                                }\r\n                                                                sx={{\r\n                                                                    borderRadius: 20,\r\n                                                                    textTransform: 'none',\r\n                                                                    fontSize: { xs: '0.7rem', sm: '0.875rem' },\r\n                                                                    padding: { xs: '4px 8px', sm: '6px 12px' },\r\n                                                                    '&:hover': {\r\n                                                                        transform: 'scale(1.05)',\r\n                                                                        transition: 'all 0.2s',\r\n                                                                    },\r\n                                                                }}\r\n                                                            >\r\n                                                                <FontAwesomeIcon icon={faBook} style={{ marginRight: 4 }} />\r\n                                                                Chi tiết\r\n                                                            </MuiButton>\r\n                                                        </div>\r\n                                                    </StyledTableCell>\r\n                                                </StyledTableRow>\r\n                                            </Fade>\r\n                                        );\r\n                                    })}\r\n                                </TableBody>\r\n                            </Table>\r\n                        </StyledTableContainer>\r\n                    </div>\r\n                </main>\r\n            </div>\r\n\r\n            <footer className={cx('footer')}>\r\n                <Footer />\r\n            </footer>\r\n\r\n            <Modal open={openModal} onClose={handleCloseModal}>\r\n                <ModalBox>\r\n                    <Typography variant=\"h6\" gutterBottom>\r\n                        Chi tiết sách mượn (Phiếu: {selectedMaphieumuon})\r\n                    </Typography>\r\n                    <Table>\r\n                        <StyledTableHead>\r\n                            <TableRow>\r\n                                <StyledTableCell>Mã Sách</StyledTableCell>\r\n                                <StyledTableCell>Tên Sách</StyledTableCell>\r\n                                <StyledTableCell>Vị Trí</StyledTableCell>\r\n                                <StyledTableCell>Số Lượng</StyledTableCell>\r\n                                <StyledTableCell>Quá Hạn</StyledTableCell>\r\n                                <StyledTableCell>Ngày Trả</StyledTableCell>\r\n                                <StyledTableCell>Ngày Hẹn Trả Mới</StyledTableCell>\r\n                                <StyledTableCell>Tình Trạng</StyledTableCell>\r\n                                <StyledTableCell>Hành Động</StyledTableCell>\r\n                            </TableRow>\r\n                        </StyledTableHead>\r\n                        <TableBody>\r\n                            {selectedBooks.map((book, index) => {\r\n                                const dueDate = book.ngayhentra || dataBooks.find(item => item.maphieumuon === selectedMaphieumuon)?.ngayhentra;\r\n                                const overdueDays = calculateOverdueDays(dueDate, book.tinhtrang, book.overdueDays);\r\n                                return (\r\n                                    <TableRow key={index}>\r\n                                        <StyledTableCell>{book.masach}</StyledTableCell>\r\n                                        <StyledTableCell>{book.tensach}</StyledTableCell>\r\n                                        <StyledTableCell>{book.mavitri}</StyledTableCell>\r\n                                        <StyledTableCell>{book.soluong}</StyledTableCell>\r\n                                        <StyledTableCell>\r\n                                            {overdueDays > 0 ? (\r\n                                                <Chip\r\n                                                    label={`${overdueDays} ngày`}\r\n                                                    color=\"error\"\r\n                                                    size=\"small\"\r\n                                                />\r\n                                            ) : (\r\n                                                'Không'\r\n                                            )}\r\n                                        </StyledTableCell>\r\n                                        <StyledTableCell>\r\n                                            {book.ngaytra ? formatDate(book.ngaytra) : 'Chưa trả'}\r\n                                        </StyledTableCell>\r\n                                        <StyledTableCell>\r\n                                            {book.giahan && book.newngayhentra\r\n                                                ? formatDate(book.newngayhentra)\r\n                                                : 'N/A'}\r\n                                        </StyledTableCell>\r\n                                        <StyledTableCell>\r\n                                            {book.tinhtrang ? (\r\n                                                <Chip\r\n                                                    icon={<FontAwesomeIcon icon={faCheck} />}\r\n                                                    label=\"Đã trả\"\r\n                                                    color=\"success\"\r\n                                                    size=\"small\"\r\n                                                />\r\n                                            ) : (\r\n                                                <Chip\r\n                                                    icon={<FontAwesomeIcon icon={faSpinner} className=\"fa-spin\" />}\r\n                                                    label=\"Đang mượn\"\r\n                                                    color=\"warning\"\r\n                                                    size=\"small\"\r\n                                                />\r\n                                            )}\r\n                                        </StyledTableCell>\r\n                                        <StyledTableCell>\r\n                                            {!book.tinhtrang && !book.giahan ? (\r\n                                                <MuiButton\r\n                                                    variant=\"contained\"\r\n                                                    size=\"small\"\r\n                                                    onClick={() => handleExtendBorrowing(selectedMaphieumuon, book.masach)}\r\n                                                    sx={{\r\n                                                        borderRadius: 20,\r\n                                                        textTransform: 'none',\r\n                                                        background: 'linear-gradient(45deg, #1976d2, #42a5f5)',\r\n                                                        fontSize: { xs: '0.7rem', sm: '0.875rem' },\r\n                                                        padding: { xs: '4px 8px', sm: '6px 12px' },\r\n                                                        '&:hover': {\r\n                                                            transform: 'scale(1.05)',\r\n                                                            transition: 'all 0.2s',\r\n                                                        },\r\n                                                    }}\r\n                                                >\r\n                                                    Gia Hạn\r\n                                                </MuiButton>\r\n                                            ) : book.giahan && !book.tinhtrang ? (\r\n                                                <Typography\r\n                                                    variant=\"body2\"\r\n                                                    color=\"text.secondary\"\r\n                                                    sx={{ fontSize: { xs: '0.7rem', sm: '0.875rem' } }}\r\n                                                >\r\n                                                    Đã gia hạn\r\n                                                </Typography>\r\n                                            ) : null}\r\n                                        </StyledTableCell>\r\n                                    </TableRow>\r\n                                );\r\n                            })}\r\n                        </TableBody>\r\n                    </Table>\r\n                    <MuiButton\r\n                        variant=\"contained\"\r\n                        onClick={handleCloseModal}\r\n                        sx={{ mt: 2, float: 'right' }}\r\n                    >\r\n                        Đóng\r\n                    </MuiButton>\r\n                </ModalBox>\r\n            </Modal>\r\n\r\n            <ToastContainer {...toastOptions} />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default HistoryBook;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}